<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sensortoolkit.plotting._scatter &mdash; sensortoolkit 0.8.3b2 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> sensortoolkit
          </a>
              <div class="version">
                0.8.3b2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html#script-templates">Script Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing and Updating sensortoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../import_sensortoolkit.html">Importing sensortoolkit</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Objects and Data Structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../testingattrib_objects/index.html">Testing Attribute Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sdfs/index.html">sensortoolkit Data Formatting Scheme (SDFS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Objects and Data Structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../evaluation_objects/index.html">Evaluation Objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">sensortoolkit API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">sensortoolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>sensortoolkit.plotting._scatter</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sensortoolkit.plotting._scatter</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains methods for constructing scatter plot figures.</span>

<span class="sd">================================================================================</span>

<span class="sd">@Author:</span>
<span class="sd">  | Samuel Frederick, NSSC Contractor (ORAU)</span>
<span class="sd">  | U.S. EPA / ORD / CEMM / AMCD / SFSB</span>

<span class="sd">Created:</span>
<span class="sd">  Mon Jan 27 08:49:12 2020</span>
<span class="sd">Last Updated:</span>
<span class="sd">  Wed Jul 28 14:11:14 2021</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas.plotting</span> <span class="kn">import</span> <span class="n">register_matplotlib_converters</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
<span class="kn">from</span> <span class="nn">sensortoolkit.calculate</span> <span class="kn">import</span> <span class="n">regression_stats</span>
<span class="kn">from</span> <span class="nn">sensortoolkit.param</span> <span class="kn">import</span> <span class="n">Parameter</span>
<span class="kn">from</span> <span class="nn">sensortoolkit.datetime_utils</span> <span class="kn">import</span> <span class="n">get_todays_date</span>
<span class="kn">from</span> <span class="nn">sensortoolkit.calculate</span> <span class="kn">import</span> <span class="n">normalize</span>
<span class="kn">from</span> <span class="nn">sensortoolkit.deploy</span> <span class="kn">import</span> <span class="n">get_max_conc</span>
<span class="kn">from</span> <span class="nn">sensortoolkit.plotting</span> <span class="kn">import</span> <span class="p">(</span><span class="n">set_fontsize</span><span class="p">,</span>
     <span class="n">sensor_subplot_formatting</span><span class="p">,</span> <span class="n">met_scatter_lims</span><span class="p">,</span> <span class="n">wrap_text</span><span class="p">,</span> <span class="n">error_bars</span><span class="p">)</span>
<span class="n">register_matplotlib_converters</span><span class="p">()</span>


<div class="viewcode-block" id="draw_scatter"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.plotting._scatter.draw_scatter.html#sensortoolkit.plotting._scatter.draw_scatter">[docs]</a><span class="k">def</span> <span class="nf">draw_scatter</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">,</span> <span class="n">sensor_stats</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">xlims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">detail_fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_regression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">colormap_vals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">colormap_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A helper function to draw scatterplots with linear regressions on passed</span>
<span class="sd">    matplotlib axes instance</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (Matplotlib axes instance):</span>
<span class="sd">            The axes object on which the scatter plot is drawn</span>
<span class="sd">        xdata (numpy array or pandas Series):</span>
<span class="sd">            The x data (reference data)</span>
<span class="sd">        ydata (numpy array or pandas Series):</span>
<span class="sd">            The y data (sensor data)</span>
<span class="sd">        param_dict (dict):</span>
<span class="sd">            Dictionary of kwargs to pass to ax.plot</span>
<span class="sd">        sensor_stats (pandas DataFrame):</span>
<span class="sd">            Dataframe contain regression statistics for single sensor (subset</span>
<span class="sd">            of the full stats_df object)</span>
<span class="sd">        xlims (tuple):</span>
<span class="sd">          The domain of the graph</span>
<span class="sd">        ylims (tuple):</span>
<span class="sd">          The range of the graph</span>
<span class="sd">        fontsize (int):</span>
<span class="sd">            Selects the fontsize of regression statistics</span>
<span class="sd">        detail_fontsize (int or float):</span>
<span class="sd">            Fontsize for axes tick labels and smaller plotting text elements.</span>
<span class="sd">        param (str):</span>
<span class="sd">            The name of the parameter for which measurements will be plotted.</span>
<span class="sd">        plot_regression (bool):</span>
<span class="sd">            True plots linear regression, regression equation, R^2, and RMSE</span>
<span class="sd">        colormap_vals (Dataframe column or none):</span>
<span class="sd">            Data that are used to set the colormap value.</span>
<span class="sd">        colormap_name (string or none):</span>
<span class="sd">            The name of the colormap which the scatter plot will be assigned</span>
<span class="sd">            The name of the Matplotlib colormap that will be used when</span>
<span class="sd">            superimposing scatter points with RH values. A full list of colormaps is</span>
<span class="sd">            can be found in the `Matplotlib documentation &lt;https://matplotlib.org/stable/gallery/color/colormap_reference.html&gt;`_</span>

<span class="sd">    **Keyword Arguments:**</span>

<span class="sd">    :param str monocolor:</span>
<span class="sd">        A single color (specified in hex) for scatter. Scatter are colored</span>
<span class="sd">        using monocolor if colormap_vals is empty. Defaults to &#39;#0048AD&#39;.</span>
<span class="sd">    :param float point_size:</span>
<span class="sd">        The size of the scatter points. Defaults to 20.</span>
<span class="sd">    :param float point_alpha:</span>
<span class="sd">        The transparency of the scatter plots. Defaults to 0.7.</span>
<span class="sd">    :param str plot_aspect:</span>
<span class="sd">        Aspect ratio for scatter plot dimensions. Defaults to &#39;equal&#39;.</span>
<span class="sd">    :param float plottext_alpha:</span>
<span class="sd">        The transparency of the text drawn on scatter plots indicating</span>
<span class="sd">        regression statistics. Defaults to 0.8.</span>
<span class="sd">    :param float plottext_size:</span>
<span class="sd">        The size of the text drawn on scatter plots indicating</span>
<span class="sd">        regression statistics as a fraction of the passed fontsize. Defaults</span>
<span class="sd">        to 90% the value of the fontsize.</span>
<span class="sd">    :param str plottext_color:</span>
<span class="sd">        The color of the text drawn on scatter plots indicating</span>
<span class="sd">        regression statistics. Defaults to &#39;k&#39;.</span>
<span class="sd">    :param float plottext_xloc:</span>
<span class="sd">        The left-most x-coordinate of the text drawn on scatter plots.</span>
<span class="sd">        Default depends on the value passed to the plottext_postion argument.</span>
<span class="sd">    :param float plottext_yloc:</span>
<span class="sd">        The top-most y-coordinate of the text drawn on scatter plots.</span>
<span class="sd">        Default depends on the value passed to the plottext_postion argument.</span>
<span class="sd">    :param float plottext_xdisplacement:</span>
<span class="sd">        The width displacement between text drawn on scatter plots. Defaults</span>
<span class="sd">        to 0.0.</span>
<span class="sd">    :param float plottext_ydisplacement:</span>
<span class="sd">        The height displacement between rows of text drawn on scatter plots.</span>
<span class="sd">        Defaults to 0.08.</span>
<span class="sd">    :param str plottext_position:</span>
<span class="sd">        Determines position of plot text. Options include &#39;upper_left&#39; or</span>
<span class="sd">        &#39;bottom_right&#39;. Defaults to &#39;upper_left&#39; if the slope of the &#39;</span>
<span class="sd">        regression is greater than  1.75, else default is set to</span>
<span class="sd">        &#39;bottom_right&#39;.</span>
<span class="sd">    :param bool show_trendline:</span>
<span class="sd">        If true, display the OLS trendline on scatter plots. Defaults to True.</span>
<span class="sd">    :param bool show_RMSE:</span>
<span class="sd">        If true, display the root mean squared error on scatter plots.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    :param bool show_spearman:</span>
<span class="sd">        If true, display the spearman correlation on scatterplots. Defaults</span>
<span class="sd">        to False.</span>
<span class="sd">    :param bool show_N:</span>
<span class="sd">        If true, display the number of scatter point pairs displayed on the</span>
<span class="sd">        plot. Defaults to True.</span>
<span class="sd">    :param bool show_one_to_one:</span>
<span class="sd">        If true, display the one-to-one line indicating ideal agreement</span>
<span class="sd">        between independent and depdendent variable. Defaults to True.</span>
<span class="sd">    :param float trendline_xmax:</span>
<span class="sd">        The draw distance (based on the passed x-coordinate) of the OLS</span>
<span class="sd">        trendline. Defaults to 120% the maximum of the independent variable.</span>
<span class="sd">    :param str trendline_color:</span>
<span class="sd">        The color of the trendline. Defaults to &#39;k&#39; (black).</span>
<span class="sd">    :param float trendline_alpha:</span>
<span class="sd">        The transparency of the trendline. Defaults to 0.65.</span>

<span class="sd">    Returns:</span>
<span class="sd">        plotobj:</span>
<span class="sd">            Matplotlib axes instance with scatter drawn along with additional</span>
<span class="sd">            elements specified in the kwargs (text, colormap)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Set keyword arguments to passed values or defaults</span>
    <span class="n">pointsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;point_size&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;point_alpha&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
    <span class="n">default_text_pos</span> <span class="o">=</span> <span class="s1">&#39;upper_left&#39;</span>
    <span class="k">if</span> <span class="n">sensor_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">sensor_stats</span><span class="o">.</span><span class="n">Slope</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">slope</span> <span class="o">&gt;</span> <span class="mf">1.75</span><span class="p">:</span>
            <span class="n">default_text_pos</span> <span class="o">=</span> <span class="s1">&#39;bottom_right&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">default_text_pos</span> <span class="o">=</span> <span class="s1">&#39;upper_left&#39;</span>
    <span class="n">text_position</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_position&#39;</span><span class="p">,</span> <span class="n">default_text_pos</span><span class="p">)</span>
    <span class="n">plot_trendline</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_trendline&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">plot_rmse</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_RMSE&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">plot_spearman</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_spearman&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">plot_n</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_N&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">plot_one_to_one</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_one_to_one&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">monocolor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;monocolor&#39;</span><span class="p">,</span> <span class="s1">&#39;#0048AD&#39;</span><span class="p">)</span>

    <span class="c1"># Set text position</span>
    <span class="k">if</span> <span class="n">text_position</span> <span class="o">==</span> <span class="s1">&#39;upper_left&#39;</span><span class="p">:</span>
        <span class="n">text_x</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="n">text_y</span> <span class="o">=</span> <span class="mf">0.90</span>
        <span class="n">text_xdisplacement</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">text_ydisplacement</span> <span class="o">=</span> <span class="mf">.08</span>
    <span class="k">elif</span> <span class="n">text_position</span> <span class="o">==</span> <span class="s1">&#39;bottom_right&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fontsize</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">text_x</span> <span class="o">=</span> <span class="mf">.45</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text_x</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="n">text_y</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">text_xdisplacement</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">text_ydisplacement</span> <span class="o">=</span> <span class="mf">.08</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;Invalid text position. Options: upper_left, bottom_right&#39;</span><span class="p">)</span>
    <span class="n">text_x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_xloc&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">text_x</span><span class="p">))</span>
    <span class="n">text_y</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_yloc&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">text_y</span><span class="p">))</span>
    <span class="n">text_xdisplacement</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_xdisplacement&#39;</span><span class="p">,</span>
                                    <span class="p">(</span><span class="n">text_xdisplacement</span><span class="p">))</span>
    <span class="n">text_ydisplacement</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_ydisplacement&#39;</span><span class="p">,</span>
                                    <span class="p">(</span><span class="n">text_ydisplacement</span><span class="p">))</span>

    <span class="c1"># Plot scatterplot with colormap, based on the colormap_vals data. If none,</span>
    <span class="c1"># plot scatter with single color (monocolor)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colormap_vals</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">plotobj</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">pointsize</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                             <span class="n">c</span><span class="o">=</span><span class="n">colormap_vals</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap_name</span><span class="p">,</span>
                             <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plotobj</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">monocolor</span><span class="p">,</span>
                             <span class="n">s</span><span class="o">=</span><span class="n">pointsize</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="c1"># Set axes labels, ticks, limits</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">detail_fontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_aspect&#39;</span><span class="p">,</span> <span class="s1">&#39;equal&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>

    <span class="c1"># Check for regression statistics</span>
    <span class="k">if</span> <span class="n">sensor_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="n">sensor_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">sensor_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Slope&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">slope</span><span class="p">):</span>
            <span class="n">plot_regression</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">plot_n</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Draw regression equation, R^2 (or spearman), RMSE, N</span>
    <span class="k">if</span> <span class="n">plot_regression</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">plot_trendline</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">trendline_xmax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trendline_xmax&#39;</span><span class="p">,</span> <span class="mf">1.2</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                <span class="n">trend_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">trendline_xmax</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">trendline_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trendline_color&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
                <span class="n">trendline_alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trendline_alpha&#39;</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trend_data</span><span class="p">,</span> <span class="n">slope</span><span class="o">*</span><span class="n">trend_data</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="n">trendline_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">trendline_alpha</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">plotobj</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">intercept</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">intercept_sign</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">intercept_sign</span> <span class="o">=</span> <span class="s1">&#39;+&#39;</span>

        <span class="n">linear_reg_str</span> <span class="o">=</span> <span class="s1">&#39;$y=</span><span class="si">{:.2f}</span><span class="s1">x$&#39;</span> <span class="o">+</span> <span class="n">intercept_sign</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span>

        <span class="n">text_alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_alpha&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">text_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_size&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">text_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plottext_color&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="c1"># Plot linear regression equation</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_x</span><span class="p">,</span> <span class="n">text_y</span><span class="p">,</span>
                <span class="n">linear_reg_str</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">),</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">text_alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">text_size</span><span class="p">)</span>

        <span class="c1"># Pearson Correlation Coefficient</span>
        <span class="n">r_square</span> <span class="o">=</span> <span class="n">sensor_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;R$^2$&#39;</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_x</span> <span class="o">-</span> <span class="n">text_xdisplacement</span><span class="p">,</span>
                <span class="n">text_y</span> <span class="o">-</span> <span class="n">text_ydisplacement</span><span class="p">,</span>
                <span class="s1">&#39;$R^2=</span><span class="si">{:.2f}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_square</span><span class="p">),</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">text_alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">text_size</span><span class="p">)</span>

        <span class="c1"># Spearman Correlation</span>
        <span class="k">if</span> <span class="n">plot_spearman</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">spearman_corr</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">text_xdisplacement</span><span class="p">,</span>
                    <span class="n">text_y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">text_ydisplacement</span><span class="p">,</span>
                    <span class="s1">&#39;$</span><span class="se">\r</span><span class="s1">ho=</span><span class="si">{:.2f}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spearman_corr</span><span class="p">),</span>
                    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">text_alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">text_size</span><span class="p">)</span>

        <span class="c1"># Root Mean Square Error</span>
        <span class="k">if</span> <span class="n">plot_rmse</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">RMSE</span> <span class="o">=</span> <span class="n">sensor_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Sensor RMSE&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">plot_spearman</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">plot_rmse</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">text_xdisplacement</span><span class="p">,</span>
                    <span class="n">text_y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">text_ydisplacement</span><span class="p">,</span>
                    <span class="s1">&#39;$RMSE=</span><span class="si">{:.2f}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">RMSE</span><span class="p">),</span>
                    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="n">text_alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">text_size</span><span class="p">)</span>

    <span class="c1"># Draw the number of scatterplot points graphed</span>
    <span class="k">if</span> <span class="n">plot_n</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">n_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sensor_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">])</span>
        <span class="c1"># place the text below Rsqr text by same coord diff</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_x</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">text_xdisplacement</span><span class="p">,</span>
                <span class="n">text_y</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">text_ydisplacement</span><span class="p">,</span>
                <span class="s1">&#39;$N= $&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n_count</span><span class="p">),</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">text_alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">text_size</span><span class="p">)</span>

    <span class="c1"># One-to-one dashed line for reference</span>
    <span class="k">if</span> <span class="n">plot_one_to_one</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">one_to_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">one_to_one</span><span class="p">,</span> <span class="n">one_to_one</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">plotobj</span></div>


<div class="viewcode-block" id="scatter_plotter"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.plotting._scatter.scatter_plotter.html#sensortoolkit.plotting._scatter.scatter_plotter">[docs]</a><span class="k">def</span> <span class="nf">scatter_plotter</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ref_df</span><span class="p">,</span> <span class="n">stats_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plot_subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sensor_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figure_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">write_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">averaging_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">met_ref_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">deploy_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sensor_serials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report_fmt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_axs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">param_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Front-end function for creating scatter plots.</span>

<span class="sd">    Calls Draw_Scatter for lower-end tasks and sets formatting for plots</span>
<span class="sd">    based off passed parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_list (list):</span>
<span class="sd">            A list containing the sensor dataframes from which data is plotted</span>
<span class="sd">        ref_df (pandas DataFrame):</span>
<span class="sd">            Reference dataframe</span>
<span class="sd">        stats_df (pandas DataFrame):</span>
<span class="sd">            Regression statistics dataframe for the sensor evaluation set</span>
<span class="sd">        plot_subset (Nonetype or list of strings):</span>
<span class="sd">            To plot a subset of evaluated sensors, pass a list of the sensor</span>
<span class="sd">            numbers (&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, etc.) as assigned in the sensor serial</span>
<span class="sd">            dictionary. For example, plotting a subset for sensors &#39;1&#39;, &#39;3&#39;,</span>
<span class="sd">            and &#39;5&#39; in an evaluation is achieved by passing</span>
<span class="sd">            plot_subset=[&#39;1&#39;, &#39;3&#39;, &#39;5&#39;].</span>
<span class="sd">        param (str):</span>
<span class="sd">            Column header name for the pollutant values to be plotted</span>
<span class="sd">        sensor_name (str):</span>
<span class="sd">            Unformatted sensor name, passed to Formatted_Sensor_Name() for</span>
<span class="sd">            including formatted version on plot</span>
<span class="sd">        figure_path (str):</span>
<span class="sd">            Path to directory where the figure will be saved</span>
<span class="sd">        write_to_file (bool):</span>
<span class="sd">            If true, writes to file and figure is closed. False skips file</span>
<span class="sd">            writing and does not close the figure</span>
<span class="sd">        averaging_interval (str):</span>
<span class="sd">            The averaging interval of the sensor and reference datasets, either</span>
<span class="sd">            &#39;1-hour&#39; or &#39;24-hour&#39;.</span>
<span class="sd">        met_ref_df (Nonetype or pandas DataFrame):</span>
<span class="sd">            Reference dataframe for met data. Used as an alternative to sensor</span>
<span class="sd">            met data for plotting colormap of relative humidity on scatterplot</span>
<span class="sd">            points. If passed, the reference met data takes precedence over</span>
<span class="sd">            any existing sensor met data.</span>
<span class="sd">        deploy_dict (dict):</span>
<span class="sd">            A dictionary containing descriptive statistics and textual</span>
<span class="sd">            information about the deployment (testing agency, site, time period,</span>
<span class="sd">            etc.), sensors tested, and site conditions during the evaluation.</span>
<span class="sd">        sensor_serials (dict):</span>
<span class="sd">            A dictionary of sensor serial identifiers for each unit in the</span>
<span class="sd">            testing deployment.</span>
<span class="sd">        ax (matplotlib.axes._subplots.AxesSubplot, optional):</span>
<span class="sd">            Optional, the Matplotlib Axes object on which plotting elements</span>
<span class="sd">            will be drawn. Useful is the user is iterating over the Axes</span>
<span class="sd">            elements of a Matplotlib figure in a for-loop outside this plotting</span>
<span class="sd">            function. Within the loop, calls to this function can be made to add</span>
<span class="sd">            elements for each axes object. Defaults to None.</span>
<span class="sd">        fig (Matplotlib.figure.Figure, optional):</span>
<span class="sd">            Optional, the Matplotlib figure on which axes object elements are</span>
<span class="sd">            drawn. Useful is the user is iterating over the Axes elements of a</span>
<span class="sd">            Matplotlib figure in a for-loop outside this plotting function.</span>
<span class="sd">            Within the loop, calls to this function can be made to add elements</span>
<span class="sd">            for each axes object. Defaults to None.</span>
<span class="sd">        report_fmt (bool):</span>
<span class="sd">            If true, select formatting presets for displaying figures on the</span>
<span class="sd">            reporting template for sensor performance evaluations included</span>
<span class="sd">            alongside US EPA&#39;s performance targets documents for air sensors.</span>
<span class="sd">        return_axs (bool, optional):</span>
<span class="sd">            If true, will return a Matplotlib axes instance (useful for</span>
<span class="sd">            iteration over subplot axes if this plotting function is called</span>
<span class="sd">            within a for-loop that is iterating over the axes elements in</span>
<span class="sd">            a Matplotlib subplot object). Defaults to False.</span>
<span class="sd">        param_class (str):</span>
<span class="sd">            The parameter classification for the passed parameter to plot.</span>
<span class="sd">            E.g, if param is PM25, param_class = PM; if param is 03,</span>
<span class="sd">            param_class = Gases;if param is Temp, param_class = Met.</span>

<span class="sd">    **Keyword Arguments:**</span>

<span class="sd">    :param str color_palette:</span>
<span class="sd">        Color palette assigned to relative-humidity colormapped scatter</span>
<span class="sd">        plot points. Defaults to ``&#39;seismic&#39;``.</span>
<span class="sd">    :param colorbar_axespos:</span>
<span class="sd">        Set the position of the colorbar axes object relative to the Matplotlib</span>
<span class="sd">        Figure coordinates. Four element tuple composed of (left-most</span>
<span class="sd">        x-coordinate, bottom-most y-coordinate, width, height) of the colobar</span>
<span class="sd">        axes object.</span>
<span class="sd">    :type colorbar_axespos: Four-element tuple</span>
<span class="sd">    :param str colorbar_orientation:</span>
<span class="sd">        The orientation of the colorbar as drawn on the figure. Either</span>
<span class="sd">        &#39;vertical&#39; or &#39;horizontal&#39;.</span>
<span class="sd">    :param colorbar_title_fontsize:</span>
<span class="sd">        The size of the &#39;Relative Humidity&#39; title assigned to the colorbar.</span>
<span class="sd">        Defaults to the value of ``&#39;detail_fontsize&#39;``.</span>
<span class="sd">    :type colorbar_tick_labelsize: int or float</span>
<span class="sd">    :param colorbar_title_ypos:</span>
<span class="sd">        The y-position of the colorbar relative to the Matplotlib Figure</span>
<span class="sd">        coordinate dimensions.</span>
<span class="sd">    :type colorbar_tick_labelsize: int or float</span>
<span class="sd">    :param colorbar_tick_labelsize:</span>
<span class="sd">        The size of the label (percentage of RH) for the colorbar. Defaults to</span>
<span class="sd">        the value of ``&#39;detail_fontsize&#39;``.</span>
<span class="sd">    :type colorbar_tick_labelsize: int or float</span>
<span class="sd">    :param colorbar_tick_length:</span>
<span class="sd">        The length of the colorbar ticks. Defaults to 4.0.</span>
<span class="sd">    :type colorbar_tick_length: int or float</span>
<span class="sd">    :param float colorbar_tick_width:</span>
<span class="sd">        The thickness (width) of the colorbar ticks. Defaults to 1.0.</span>
<span class="sd">    :param bool draw_cbar:</span>
<span class="sd">        If True, relative humidity values will be superimposed on to</span>
<span class="sd">        sensor-reference measurement pairs via the specified</span>
<span class="sd">        color palette (``&#39;color_palette&#39;``) and a colorbar will be drawn</span>
<span class="sd">        alongside the scatter subplots as a legend for colored RH values.</span>
<span class="sd">    :param float fig_wspace:</span>
<span class="sd">        Modify the width of padding between subplots. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;wspace&#39;`` argument.</span>
<span class="sd">    :param float fig_hspace:</span>
<span class="sd">        Modify the height of padding between subplots. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;hspace&#39;`` argument.</span>
<span class="sd">    :param float fig_left:</span>
<span class="sd">        Modify the left-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;left&#39;`` argument.</span>
<span class="sd">    :param float fig_right:</span>
<span class="sd">        Modify the right-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;right&#39;`` argument.</span>
<span class="sd">    :param float fig_top:</span>
<span class="sd">        Modify the upper-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;top&#39;`` argument.</span>
<span class="sd">    :param float fig_bottom:</span>
<span class="sd">        Modify the lower-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;bottom&#39;`` argument.</span>
<span class="sd">    :param str filename_suffix:</span>
<span class="sd">        Optional string added to end of filename. Defaults to empty string.</span>
<span class="sd">    :param fontsize:</span>
<span class="sd">        The font size for the xlabel, ylabel, and plot text. Passed on to</span>
<span class="sd">        Draw_Scatter() which uses 0.85*font_size for tick labels.</span>
<span class="sd">    :type fontsize: str, passed to Draw_Scatter()</span>
<span class="sd">    :param monocolor:</span>
<span class="sd">        A single color (specified in hex) for scatter. Scatter are colored</span>
<span class="sd">        using monocolor if show_colorbar is False. Recommend #2251D0 (nice</span>
<span class="sd">        blue hue).</span>
<span class="sd">    :type monocolor: str, passed to Draw_Scatter()</span>
<span class="sd">    :param float detail_fontsize:</span>
<span class="sd">        Fontsize for axes tick labels and smaller plotting text elements.</span>
<span class="sd">    :param point_size:</span>
<span class="sd">        The size of the scatter points. Defaults to 20.</span>
<span class="sd">    :type point_size: int or float, passed to Draw_Scatter()</span>
<span class="sd">    :param float point_alpha:</span>
<span class="sd">        The transparency of the scatter plots. Defaults to 0.7.</span>
<span class="sd">    :param plot_aspect:</span>
<span class="sd">        Aspect ratio for scatter plot dimensions. Defaults to &#39;equal&#39;.</span>
<span class="sd">    :type plot_aspect: str, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_alpha:</span>
<span class="sd">        The transparency of the text drawn on scatter plots indicating</span>
<span class="sd">        regression statistics. Defaults to 0.8.</span>
<span class="sd">    :type plottext_alpha: float, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_size:</span>
<span class="sd">        The size of the text drawn on scatter plots indicating</span>
<span class="sd">        regression statistics as a fraction of the passed fontsize. Defaults</span>
<span class="sd">        to 90% the value of the fontsize.</span>
<span class="sd">    :type plottext_size: float, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_color:</span>
<span class="sd">        The color of the text drawn on scatter plots indicating</span>
<span class="sd">        regression statistics. Defaults to &#39;k&#39;.</span>
<span class="sd">    :type plottext_color: str, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_xloc:</span>
<span class="sd">        The left-most x-coordinate of the text drawn on scatter plots.</span>
<span class="sd">        Default depends on the value passed to the plottext_postion argument.</span>
<span class="sd">    :type plottext_xloc: float, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_yloc:</span>
<span class="sd">        The top-most y-coordinate of the text drawn on scatter plots.</span>
<span class="sd">        Default depends on the value passed to the plottext_postion argument.</span>
<span class="sd">    :type plottext_yloc: float, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_xdisplacement:</span>
<span class="sd">        The width displacement between text drawn on scatter plots. Defaults</span>
<span class="sd">        to 0.0.</span>
<span class="sd">    :type plottext_xdisplacement: float, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_ydisplacement:</span>
<span class="sd">        The height displacement between rows of text drawn on scatter plots.</span>
<span class="sd">        Defaults to 0.08.</span>
<span class="sd">    :type plottext_ydisplacement: float, passed to Draw_Scatter()</span>
<span class="sd">    :param plottext_position:</span>
<span class="sd">        Determines position of plot text. Options include &#39;upper_left&#39; or</span>
<span class="sd">        &#39;bottom_right&#39;. Defaults to &#39;upper_left&#39; if the slope of the &#39;</span>
<span class="sd">        regression is greater than  1.75, else default is set to</span>
<span class="sd">        &#39;bottom_right&#39;.</span>
<span class="sd">    :type plottext_position: TYPE, passed to Draw_Scatter()</span>
<span class="sd">    :param str ref_name:</span>
<span class="sd">        The name of the reference monitor (make, model).</span>
<span class="sd">    :param str seaborn_style:</span>
<span class="sd">        Seaborn plotting style for plots. Options include</span>
<span class="sd">        ``[&#39;darkgrid&#39;, &#39;whitegrid&#39;, &#39;dark&#39;, &#39;white&#39;, &#39;ticks&#39;]``. Defaults to</span>
<span class="sd">        ``&#39;darkgrid&#39;``.</span>
<span class="sd">    :param bool show_colorbar:</span>
<span class="sd">        If true, relative humidity values will be used as a colormap on the</span>
<span class="sd">        scatterplot points.</span>
<span class="sd">    :param bool show_title:</span>
<span class="sd">        Show the title at the top of the plot. Includes the name of the</span>
<span class="sd">        sensor, the averaging interval, the evaluation parameter, and</span>
<span class="sd">        the name of the reference against which sensor data are compared.</span>
<span class="sd">    :param bool show_regression:</span>
<span class="sd">        If true, display the OLS regression equation on scatter plots.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    :param bool show_trendline:</span>
<span class="sd">        If true, display the OLS trendline on scatter plots. Defaults to True.</span>
<span class="sd">    :param show_RMSE:</span>
<span class="sd">        If true, display the root mean squared error on scatter plots.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    :type show_RMSE: bool, passed to Draw_Scatter()</span>
<span class="sd">    :param show_spearman:</span>
<span class="sd">        If true, display the spearman correlation on scatterplots. Defaults</span>
<span class="sd">        to False.</span>
<span class="sd">    :type show_spearman: bool, passed to Draw_Scatter()</span>
<span class="sd">    :param show_N:</span>
<span class="sd">        If true, display the number of scatter point pairs displayed on the</span>
<span class="sd">        plot. Defaults to True.</span>
<span class="sd">    :type show_N: bool, passed to Draw_Scatter()</span>
<span class="sd">    :param show_one_to_one:</span>
<span class="sd">        If true, display the one-to-one line indicating ideal agreement</span>
<span class="sd">        between independent and depdendent variable. Defaults to True.</span>
<span class="sd">    :type show_one_to_one: bool, passed to Draw_Scatter()</span>
<span class="sd">    :param bool tight_layout:</span>
<span class="sd">        Passed to matplotlib&#39;s ``fig.tight_layout()`` for narrow formatting</span>
<span class="sd">    :param tick_spacing:</span>
<span class="sd">        The spacing (in concentration units) between adjacent tick marks along</span>
<span class="sd">        the x and y-axes.</span>
<span class="sd">    :type tick_spacing: int or float</span>
<span class="sd">    :param str title_text:</span>
<span class="sd">        The title text displayed above the figure subplots.</span>
<span class="sd">    :param int title_textwrap:</span>
<span class="sd">        The number of characters to include on a single line of the title</span>
<span class="sd">        before inserting a new line.</span>
<span class="sd">    :param float title_xloc:</span>
<span class="sd">        The center horizontal Matplotlib Axes location of the plot title.</span>
<span class="sd">    :param float title_yloc:</span>
<span class="sd">        The center vertical Matplotlib Axes location of the plot title.</span>
<span class="sd">    :param trendline_xmax:</span>
<span class="sd">        The draw distance (based on the passed x-coordinate) of the OLS</span>
<span class="sd">        trendline. Defaults to 120% the maximum of the independent variable.</span>
<span class="sd">    :type trendline_xmax: TYPE, passed to Draw_Scatter()</span>
<span class="sd">    :param trendline_color:</span>
<span class="sd">        The color of the trendline. Defaults to &#39;k&#39; (black).</span>
<span class="sd">    :type trendline_color: str, passed to Draw_Scatter()</span>
<span class="sd">    :param trendline_alpha:</span>
<span class="sd">        The transparency of the trendline. Defaults to 0.65.</span>
<span class="sd">    :type trendline_alpha: float, passed to Draw_Scatter()</span>
<span class="sd">    :param xlims:</span>
<span class="sd">        The x-limits of the scatter plot. Defaults to zero for the lower</span>
<span class="sd">        limit. For the upper limit, the following forumla is used:</span>

<span class="sd">        .. math::</span>

<span class="sd">            x_{max} = 1.25\\times C_{max} + (\\Delta_{tick} - 1.25\\times C_{max}\\%\\Delta_{tick})</span>

<span class="sd">        where:</span>

<span class="sd">          - :math:`x_{max}` is the upper limit of the x-axis</span>

<span class="sd">          - :math:`C_{max}` is the maximum value for either dependent or</span>
<span class="sd">            independent variable</span>

<span class="sd">          - :math:`\\%` is the modulo operator</span>

<span class="sd">          - :math:`\\Delta_{tick}` is the spacing between ticks along the</span>
<span class="sd">            x and y-axes (set by the ``tick_spacing`` argument)</span>

<span class="sd">        This forumla can be described in the following way:</span>
<span class="sd">        The upper limit is set to 125% the nearest multiple of the tick_spacing</span>
<span class="sd">        argument to the maximum concentration recorded by either independent</span>
<span class="sd">        or dependent variable (e.g., if the max concentration recorded by</span>
<span class="sd">        either sensor or reference is 22.4 ug/m^3 and the tick_spacing is set</span>
<span class="sd">        to divisions of 5 ug/m^3, the x upper limit will be set to 1.25*22.4</span>
<span class="sd">        = 28 -&gt; rounded to the nearest multiple of 5 ug/m^3 becomes 30 ug/m^3.</span>

<span class="sd">    :type xlims: Two-element tuple of floats</span>
<span class="sd">    :param ylims:</span>
<span class="sd">        The y-limits of the scatter plot. Defaults to zero for the lower</span>
<span class="sd">        limit. For the default upper y-limit, the value is set equal to the</span>
<span class="sd">        value computed for the x-limit above (i.e., the figure dimensions</span>
<span class="sd">        along both axes are set equal).</span>
<span class="sd">    :type ylims: Two-element tuple of floats</span>

<span class="sd">    Returns:</span>
<span class="sd">        (matplotlib axes instance or None):</span>
<span class="sd">            If an axis is passed to ``Scatter_Plotter()``, the modified axis</span>
<span class="sd">            with plotting detail filled in will be returned. Otherwise, none</span>
<span class="sd">            will be returned.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;seaborn_style&#39;</span><span class="p">,</span> <span class="s1">&#39;darkgrid&#39;</span><span class="p">))</span>
    <span class="n">palette</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;color_palette&#39;</span><span class="p">,</span> <span class="s1">&#39;seismic&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

    <span class="n">RH_colormap</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_colorbar&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">plot_title</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_title&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">plot_regression</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_regression&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="n">title_text</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title_text&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">ref_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ref_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown Reference&#39;</span><span class="p">)</span>
    <span class="n">tight_layout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tight_layout&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">filename_suffix</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;filename_suffix&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">RH_colormap</span><span class="p">:</span>
        <span class="n">draw_cbar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;draw_cbar&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">param_class</span> <span class="o">==</span> <span class="s1">&#39;Met&#39;</span><span class="p">:</span>
        <span class="n">met_ref_df</span> <span class="o">=</span> <span class="n">ref_df</span>

    <span class="c1"># Option to supply df_list indicies in list for subset of sensors to plot</span>
    <span class="k">if</span> <span class="n">plot_subset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="c1"># Subset by serial ID</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">sensor_serials</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">plot_subset</span><span class="p">):</span>
            <span class="n">subset_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sensor_serials</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                           <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">plot_subset</span><span class="p">]</span>
            <span class="n">plot_subset</span> <span class="o">=</span> <span class="n">subset_keys</span>
        <span class="c1"># Subset by the integer number associated with the serial ID</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">sensor_serials</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">plot_subset</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid list of subset keys. Pass either a list&#39;</span>
                             <span class="s1">&#39; of serial IDs or a list of the integer indices&#39;</span>
                             <span class="s1">&#39; associated with each serial ID.&#39;</span><span class="p">)</span>

        <span class="c1"># limit dataframe list and sensor serials to selected sensors</span>
        <span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                   <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">plot_subset</span><span class="p">]</span>
        <span class="n">sensor_serials</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="n">serial</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">serial</span> <span class="ow">in</span>
                          <span class="nb">enumerate</span><span class="p">(</span><span class="n">sensor_serials</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
                          <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">plot_subset</span><span class="p">}</span>

    <span class="n">param_obj</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">param_name</span> <span class="o">=</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">name</span>
    <span class="n">fmt_param</span> <span class="o">=</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">format_name</span>
    <span class="n">fmt_param_units</span> <span class="o">=</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">units</span>

    <span class="n">fmt_sensor_name</span> <span class="o">=</span> <span class="n">sensor_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="c1"># For occasions where a dataframe is passed rather than a list</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: Dataframe passed to function is not in the form &#39;</span>
              <span class="s1">&#39;of a list</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Continuing by placing passed dataframe into list&#39;</span><span class="p">)</span>
        <span class="n">df_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_list</span><span class="p">]</span>

    <span class="n">number_of_sensors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;sensor_serials&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensor_serials</span>
    <span class="n">fmt_tuple</span> <span class="o">=</span> <span class="n">sensor_subplot_formatting</span><span class="p">(</span><span class="n">number_of_sensors</span><span class="p">,</span> <span class="n">param_obj</span><span class="p">,</span>
                                          <span class="n">report_fmt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="p">(</span><span class="n">Nr</span><span class="p">,</span> <span class="n">Nc</span><span class="p">,</span> <span class="n">fig_size</span><span class="p">,</span> <span class="n">suptitle_xpos</span><span class="p">,</span> <span class="n">suptitle_ypos</span><span class="p">,</span> <span class="n">title_textwrap</span><span class="p">,</span>
     <span class="n">detail_fontsize</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span>
     <span class="n">auto_filename_suffix</span><span class="p">,</span> <span class="n">cbar_padding</span><span class="p">,</span> <span class="n">cbar_aspect</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span> <span class="o">=</span> <span class="n">fmt_tuple</span>

    <span class="c1"># Update fontsize if particular value specified</span>
    <span class="n">font_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fontsize&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="p">)</span>
    <span class="c1"># dropped, variable &#39;font_size&#39; passed to Draw_Scatter</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fontsize&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># Avoids multiple args passed to same param</span>
    <span class="n">detail_fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;detail_fontsize&#39;</span><span class="p">,</span> <span class="n">detail_fontsize</span><span class="p">)</span>

    <span class="c1"># Set concentration limits for x and y axes to the nearest multilple of</span>
    <span class="c1"># 5 for 125% of the max concentration recorded by collocated sensors.</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">])</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">])</span>
    <span class="n">max_conc</span> <span class="o">=</span> <span class="n">get_max_conc</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="n">df_list</span><span class="o">=</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ref_df</span><span class="o">=</span><span class="n">ref_df</span><span class="p">,</span>
                            <span class="n">bdate</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">edate</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>

    <span class="n">divisions</span>  <span class="o">=</span> <span class="mi">100</span>
    <span class="n">default_tick_spacing</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">divisions</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">default_tick_spacing</span> <span class="o">+=</span> <span class="mi">5</span>
        <span class="n">divisions</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">1.25</span><span class="o">*</span><span class="n">max_conc</span> <span class="o">/</span> <span class="n">default_tick_spacing</span><span class="p">)</span>

    <span class="n">tick_spacing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tick_spacing&#39;</span><span class="p">,</span> <span class="n">default_tick_spacing</span><span class="p">)</span>

    <span class="n">xlims</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlims&#39;</span><span class="p">,</span>
                       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tick_spacing</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.25</span><span class="o">*</span><span class="n">max_conc</span><span class="o">/</span><span class="n">tick_spacing</span><span class="p">)))</span>
    <span class="n">ylims</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylims&#39;</span><span class="p">,</span>
                       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tick_spacing</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="mf">1.25</span><span class="o">*</span><span class="n">max_conc</span><span class="o">/</span><span class="n">tick_spacing</span><span class="p">)))</span>

    <span class="n">xlims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">xlims</span><span class="p">)</span>
    <span class="n">ylims</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ylims</span><span class="p">)</span>

    <span class="c1"># Remove axes limits from kwargs if specified</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xlims&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ylims&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ax</span> <span class="ow">and</span> <span class="n">fig</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># No axes object passed to function, create unique fig, axes objects</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span> <span class="n">Nc</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
        <span class="n">unique_ax_obj</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Axes object passed to function, set axes within scope of function to</span>
        <span class="c1"># passed axes object.</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="n">unique_ax_obj</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig_wspace&#39;</span><span class="p">,</span> <span class="n">wspace</span><span class="p">),</span>
                        <span class="n">hspace</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig_hspace&#39;</span><span class="p">,</span> <span class="n">hspace</span><span class="p">),</span>
                        <span class="n">left</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig_left&#39;</span><span class="p">,</span> <span class="n">left</span><span class="p">),</span>
                        <span class="n">right</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig_right&#39;</span><span class="p">,</span> <span class="n">right</span><span class="p">),</span>
                        <span class="n">top</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig_top&#39;</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span>
                        <span class="n">bottom</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig_bottom&#39;</span><span class="p">,</span> <span class="n">bottom</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">plot_title</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">title_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title_text</span> <span class="o">=</span> <span class="p">(</span><span class="n">fmt_sensor_name</span> <span class="o">+</span> <span class="s1">&#39; vs. &#39;</span> <span class="o">+</span> <span class="n">ref_name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span>
                          <span class="n">averaging_interval</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">fmt_param</span><span class="p">)</span>

        <span class="n">title_text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">title_text</span><span class="p">,</span>
                                    <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title_textwrap&#39;</span><span class="p">,</span>
                                               <span class="n">title_textwrap</span><span class="p">)))</span>

        <span class="n">n_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">title_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">n_lines</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># shift the figure down a tad if 3 or more lines</span>
            <span class="n">font_size</span> <span class="o">*=</span> <span class="mf">0.9</span>
            <span class="n">suptitle_ypos</span> <span class="o">*=</span> <span class="mf">1.03</span>

        <span class="k">if</span> <span class="n">unique_ax_obj</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title_text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                         <span class="n">y</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title_yloc&#39;</span><span class="p">,</span> <span class="n">suptitle_ypos</span><span class="p">),</span>
                         <span class="n">x</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title_xloc&#39;</span><span class="p">,</span> <span class="n">suptitle_xpos</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axs</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                          <span class="n">y</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title_yloc&#39;</span><span class="p">,</span> <span class="n">suptitle_ypos</span><span class="p">),</span>
                          <span class="n">x</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title_xloc&#39;</span><span class="p">,</span> <span class="n">suptitle_xpos</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nc</span><span class="p">):</span>
            <span class="n">sensor_number</span> <span class="o">=</span> <span class="n">Nc</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">sensor_idx</span> <span class="o">=</span> <span class="n">sensor_number</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="c1"># set appropriate plt axes array index based on # of sensors</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="c1"># More than one sensor, axes arranged in array structure</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span>

            <span class="k">if</span> <span class="n">sensor_number</span> <span class="o">&gt;</span> <span class="n">number_of_sensors</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                <span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="n">auto_filename_suffix</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">Nr</span><span class="o">*</span><span class="n">Nc</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">Nr</span><span class="o">*</span><span class="n">Nc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">continue</span>

            <span class="c1"># Initialize sensor, reference dataframe objects to None</span>
            <span class="n">sensor_stats</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hourly_df_obj</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">hourly_ref_df</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">daily_df_obj</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">daily_ref_df</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># Choose between serial ID and sensor number labels for legend</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sensor_serials</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">lbl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sensor_serials</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="n">sensor_idx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lbl</span> <span class="o">=</span> <span class="s1">&#39;Sensor &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sensor_number</span><span class="p">)</span>

            <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ref_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">fmt_param</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">fmt_param_units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lbl</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">fmt_param</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">fmt_param_units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">}</span>

            <span class="c1"># set appropriate plt axes array index based on # of sensors</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">detail_fontsize</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">sensor_df</span> <span class="o">=</span> <span class="n">df_list</span><span class="p">[</span><span class="n">sensor_idx</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sensor index&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">sensor_idx</span><span class="p">),</span> <span class="s1">&#39;not in dataframe list&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                <span class="n">auto_filename_suffix</span> <span class="o">=</span> <span class="n">auto_filename_suffix</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="n">Nr</span><span class="o">*</span><span class="n">Nc</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">Nr</span><span class="o">*</span><span class="n">Nc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">break</span>

            <span class="c1"># tdelta_interval = sensor_df.index[1] - sensor_df.index[0]</span>

            <span class="c1"># if (tdelta_interval) == pd.Timedelta(&#39;1 days&#39;):</span>
            <span class="c1">#     daily_df_obj = [sensor_df]</span>
            <span class="c1">#     daily_ref_df = ref_df</span>

            <span class="c1"># if (tdelta_interval) == pd.Timedelta(&#39;1 hour&#39;):</span>
            <span class="c1">#     hourly_df_obj = [sensor_df]</span>
            <span class="c1">#     hourly_ref_df = ref_df</span>

            <span class="k">if</span> <span class="n">plot_regression</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">sensor_stats</span> <span class="o">=</span> <span class="n">regression_stats</span><span class="p">(</span><span class="n">sensor_df_obj</span><span class="o">=</span><span class="n">sensor_df</span><span class="p">,</span>
                                                <span class="n">ref_df_obj</span><span class="o">=</span><span class="n">ref_df</span><span class="p">,</span>
                                                <span class="n">deploy_dict</span><span class="o">=</span><span class="n">deploy_dict</span><span class="p">,</span>
                                                <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span>
                                                <span class="n">serials</span><span class="o">=</span><span class="n">sensor_serials</span><span class="p">,</span>
                                                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ydata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensor_df</span><span class="p">[</span><span class="n">param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span>
                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;xdata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref_df</span><span class="p">[</span><span class="n">param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ref_name</span> <span class="o">+</span> <span class="s1">&#39; not in passed reference dataframe.&#39;</span><span class="p">)</span>

            <span class="c1"># Optional combine of RH data from AIRS and sensor, where the AIRS</span>
            <span class="c1"># data is preferred and sensor data used if AIRS RH not available</span>
            <span class="k">if</span> <span class="n">RH_colormap</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;mean_RH_Value&#39;</span> <span class="ow">in</span> <span class="n">sensor_df</span><span class="p">:</span>
                        <span class="n">sensor_df</span> <span class="o">=</span> <span class="n">sensor_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mean_RH_Value&#39;</span><span class="p">:</span>
                                                              <span class="s1">&#39;RH_Value&#39;</span><span class="p">})</span>

                    <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">met_ref_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span> <span class="ow">and</span>
                       <span class="p">(</span><span class="n">met_ref_df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">)):</span>
                        <span class="k">if</span> <span class="s1">&#39;RH_Value&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sensor_df</span><span class="p">:</span>
                            <span class="n">sensor_df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

                        <span class="c1"># Ref RH data left join with sensor RH data</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">met_ref_df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span>
                              <span class="n">sensor_df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">missing_param</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">missing_param</span><span class="p">,</span>
                                  <span class="s1">&#39;not found in met reference dataframe&#39;</span><span class="p">)</span>

                        <span class="n">cmap_vals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensor_df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Reference RH not found, internal sensor RH&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;shown in figure&#39;</span><span class="p">)</span>
                        <span class="n">cmap_vals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensor_df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Reference RH not found, internal sensor RH&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;shown in figure&#39;</span><span class="p">)</span>
                    <span class="n">cmap_vals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;RH_Value&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cmap_vals</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">palette</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">xdata</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;xdata&#39;</span><span class="p">]</span>
            <span class="n">ydata</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ydata&#39;</span><span class="p">]</span>

            <span class="n">im</span> <span class="o">=</span> <span class="n">draw_scatter</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
                              <span class="n">xdata</span><span class="p">,</span>
                              <span class="n">ydata</span><span class="p">,</span>
                              <span class="n">param_dict</span><span class="p">,</span>
                              <span class="n">sensor_stats</span><span class="p">,</span>
                              <span class="n">colormap_vals</span><span class="o">=</span><span class="n">cmap_vals</span><span class="p">,</span>
                              <span class="n">colormap_name</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
                              <span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span>
                              <span class="n">ylims</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span>
                              <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span>
                              <span class="n">detail_fontsize</span><span class="o">=</span><span class="n">detail_fontsize</span><span class="p">,</span>
                              <span class="n">plot_regression</span><span class="o">=</span><span class="n">plot_regression</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">tick_spacing</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">tick_spacing</span><span class="p">))</span>

    <span class="c1"># Plot colorbar</span>
    <span class="k">if</span> <span class="n">RH_colormap</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ctitle</span> <span class="o">=</span> <span class="s1">&#39;Relative Humidity (%)&#39;</span>
            <span class="n">cbar_orien</span> <span class="o">=</span> <span class="s1">&#39;horizontal&#39;</span>
            <span class="n">cbar_size</span> <span class="o">=</span> <span class="mf">0.3</span>
            <span class="n">cbar_ypos</span> <span class="o">=</span> <span class="mf">0.6</span>

            <span class="k">if</span> <span class="n">number_of_sensors</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">cbar_size</span> <span class="o">=</span> <span class="mf">0.8</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_obj</span><span class="o">.</span><span class="n">averaging</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">cbar_orien</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span>
                    <span class="n">cbar_ypos</span> <span class="o">=</span> <span class="mf">1.01</span>
                    <span class="c1"># axes positioning [x0, y0, width, height]</span>
                    <span class="n">caxes_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.66</span><span class="p">]</span>
                    <span class="n">ctitle</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">ctitle</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">caxes_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">caxes_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">number_of_sensors</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                <span class="n">caxes_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">caxes_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.37</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]</span>

            <span class="n">cbar_pos</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colorbar_axespos&#39;</span><span class="p">,</span> <span class="n">caxes_pos</span><span class="p">)</span>
            <span class="n">cbar_orien</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colorbar_orientation&#39;</span><span class="p">,</span> <span class="n">cbar_orien</span><span class="p">)</span>

            <span class="c1"># For cases where axes object passed to function: Checkl if the</span>
            <span class="c1"># colorbar has been drawn onto the passed axes. If so, dont</span>
            <span class="c1"># duplicate to avoid matplotlib depreciation warning</span>
            <span class="k">if</span> <span class="n">draw_cbar</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">cbar_pos</span><span class="p">),</span>
                                    <span class="n">orientation</span><span class="o">=</span><span class="n">cbar_orien</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">cbar_padding</span><span class="p">,</span>
                                    <span class="n">aspect</span><span class="o">=</span><span class="n">cbar_aspect</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="n">cbar_size</span><span class="p">)</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ctitle</span><span class="p">,</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colorbar_title_fontsize&#39;</span><span class="p">,</span>
                                            <span class="n">detail_fontsize</span><span class="p">),</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colorbar_title_ypos&#39;</span><span class="p">,</span> <span class="n">cbar_ypos</span><span class="p">))</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span>
                        <span class="n">labelsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colorbar_tick_labelsize&#39;</span><span class="p">,</span>
                                             <span class="n">detail_fontsize</span><span class="p">),</span>
                        <span class="n">length</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colorbar_tick_length&#39;</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span>
                        <span class="n">width</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;colorbar_tick_width&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>

        <span class="c1"># Error when all passed x or y data are empty. Do not write to file.</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">write_to_file</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">tight_layout</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="c1"># Save image to folder at figure_path</span>
    <span class="k">if</span> <span class="n">write_to_file</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

        <span class="c1"># Sensor vs ref Temp or RH should be saved to the &#39;Met&#39; subfolder,</span>
        <span class="c1"># modify param for correct file path</span>
        <span class="k">if</span> <span class="n">param_class</span> <span class="o">==</span> <span class="s1">&#39;Met&#39;</span><span class="p">:</span>
            <span class="n">param_name</span> <span class="o">=</span> <span class="n">param_class</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sensor_name</span><span class="si">}</span><span class="s1">_vs_</span><span class="si">{</span><span class="n">ref_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">figure_path</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>

        <span class="c1"># if matplotlib axes object not passed to Scatter_Plotter, the figure</span>
        <span class="c1"># created will be for data at the averaging interval specified by</span>
        <span class="c1"># the averaging_interval variable. In this case, indicate the avg interval</span>
        <span class="c1"># in the filename</span>
        <span class="k">if</span> <span class="n">unique_ax_obj</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">+=</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">averaging_interval</span>
        <span class="k">if</span> <span class="n">filename_suffix</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">filename_suffix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">auto_filename_suffix</span>

        <span class="n">todays_date</span> <span class="o">=</span> <span class="n">get_todays_date</span><span class="p">()</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">todays_date</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Return the ax axes instance for iteration</span>
    <span class="k">if</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">unique_ax_obj</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span>

    <span class="c1"># Return a unique axes instance</span>
    <span class="k">if</span> <span class="n">return_axs</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">axs</span></div>


<div class="viewcode-block" id="normalized_met_scatter"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.plotting._scatter.normalized_met_scatter.html#sensortoolkit.plotting._scatter.normalized_met_scatter">[docs]</a><span class="k">def</span> <span class="nf">normalized_met_scatter</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ref_df</span><span class="p">,</span> <span class="n">avg_df</span><span class="p">,</span> <span class="n">met_ref_df</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">figure_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">met_param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">sensor_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">write_to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">sensor_serials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ref_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">report_fmt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">return_mpl_obj</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot parameter values normalized by reference values against either</span>
<span class="sd">    temperature or relative humidity.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_list (list):</span>
<span class="sd">            A list containing sensor datasets (1-hour averges) with parameter</span>
<span class="sd">            measurements.</span>
<span class="sd">        ref_df (pandas DataFrame):</span>
<span class="sd">            Reference dataset with collocated monitor measurements for the</span>
<span class="sd">            specified parameter.</span>
<span class="sd">        avg_df (pandas DataFrame):</span>
<span class="sd">            A dataset containing the intersensor average for concurrently</span>
<span class="sd">            recorded sensor measurements for each parameter measured by the</span>
<span class="sd">            air sensor.</span>
<span class="sd">        met_ref_df (pandas DataFrame, optional):</span>
<span class="sd">            Meteorological reference data (1-hour averages) for temperature,</span>
<span class="sd">            relative humidity, and dew point measurements. Defaults to None.</span>
<span class="sd">        figure_path (str, optional):</span>
<span class="sd">            Path to directory where the figure will be saved. Defaults to None.</span>
<span class="sd">        param (str, optional):</span>
<span class="sd">            Column header name for the parameter values to be plotted. Defaults</span>
<span class="sd">            to None.</span>
<span class="sd">        met_param (str, optional):</span>
<span class="sd">            The meteorological parameter plotted along the x-axis of the</span>
<span class="sd">            scatter plot. Defaults to None.</span>
<span class="sd">        sensor_name (str, optional):</span>
<span class="sd">            The name of the air sensor (make, manufacturer). Defaults to None.</span>
<span class="sd">        write_to_file (bool, optional):</span>
<span class="sd">            If true, the figure will be saved as a png image to the</span>
<span class="sd">            ``[project_path]/figures`` subdirectory. Defaults to True.</span>
<span class="sd">        sensor_serials (dict, optional):</span>
<span class="sd">            A dictionary of sensor serial identifiers for each unit in the</span>
<span class="sd">            testing deployment. Defaults to None.</span>
<span class="sd">        ref_name (str, optional):</span>
<span class="sd">            The name of the reference monitor collocated alongside the air</span>
<span class="sd">            sensors that recorded concurrent measurement pairs for the specified</span>
<span class="sd">            parameter. Defaults to None.</span>
<span class="sd">        report_fmt (bool, optional):</span>
<span class="sd">            If true, select formatting presets for displaying figures on the</span>
<span class="sd">            reporting template for sensor performance evaluations included</span>
<span class="sd">            alongside US EPA&#39;s performance targets documents for air sensors.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        fig (Matplotlib.figure.Figure, optional):</span>
<span class="sd">            Optional, the Matplotlib figure on which axes object elements are</span>
<span class="sd">            drawn. Useful is the user is iterating over the Axes elements of a</span>
<span class="sd">            Matplotlib figure in a for-loop outside this plotting function.</span>
<span class="sd">            Within the loop, calls to this function can be made to add elements</span>
<span class="sd">            for each axes object. Defaults to None.</span>
<span class="sd">        ax (matplotlib.axes._subplots.AxesSubplot, optional):</span>
<span class="sd">            Optional, the Matplotlib Axes object on which plotting elements</span>
<span class="sd">            will be drawn. Useful is the user is iterating over the Axes</span>
<span class="sd">            elements of a Matplotlib figure in a for-loop outside this plotting</span>
<span class="sd">            function. Within the loop, calls to this function can be made to add</span>
<span class="sd">            elements for each axes object. Defaults to None.</span>
<span class="sd">        return_mpl_obj (bool, optional):</span>
<span class="sd">            If true, will return a Matplotlib axes instance (useful for</span>
<span class="sd">            iteration over subplot axes if this plotting function is called</span>
<span class="sd">            within a for-loop that is iterating over the axes elements in</span>
<span class="sd">            a Matplotlib subplot object). Defaults to False.</span>

<span class="sd">    **Keyword Arguments:**</span>

<span class="sd">    :param point_size:</span>
<span class="sd">        The size of the scatter points. Defaults to 12</span>
<span class="sd">    :type point_size: float or int, passed to Draw_Scatter()</span>
<span class="sd">    :param point_alpha:</span>
<span class="sd">        The transparency of the scatter plots. Defaults to 0.5.</span>
<span class="sd">    :type point_alpha: float, passed to Draw_Scatter()</span>
<span class="sd">    :param list point_colors:</span>
<span class="sd">        A list of strings indicating colors for each sensor scatter - either</span>
<span class="sd">        color hex codes or `valid color names recognized by Matplotlib &lt;https://matplotlib.org/stable/gallery/color/named_colors.html&gt;`_.</span>
<span class="sd">        Defaults to None.</span>
<span class="sd">    :param xlims:</span>
<span class="sd">        Set the x-limits of the plot. Defaults to None.</span>
<span class="sd">    :type xlims: Two-element tuple</span>
<span class="sd">    :param ylims:</span>
<span class="sd">        Set the y-limits of the plot. Defaults to None.</span>
<span class="sd">    :type ylims: Two-element tuple</span>
<span class="sd">    :param cmap_norm_range:</span>
<span class="sd">        A two-element tuple containing the normalized range of the colormap</span>
<span class="sd">        values that will be displayed in the figure. The full range of the</span>
<span class="sd">        selected colormap can be selected by passing (0, 1). Hues will</span>
<span class="sd">        be selected at equally spaced intervals within the normalized</span>
<span class="sd">        colormap range specified.  Defaults to (0, 0.4).</span>
<span class="sd">    :type cmap_norm_range: Two-element tuple</span>
<span class="sd">    :param cmap_name:</span>
<span class="sd">        The name of the colormap which the scatter plot will be assigned.</span>
<span class="sd">        Defaults to &#39;Set1&#39;.</span>
<span class="sd">    :type cmap_name: str, passed to Draw_Scatter()</span>
<span class="sd">    :param fontsize:</span>
<span class="sd">        The fontsize of plot titles and labels. Defaults to 12.</span>
<span class="sd">    :type fontsize: int or float, passed to Draw_Scatter()</span>
<span class="sd">    :param detail_fontsize:</span>
<span class="sd">        Fontsize for axes tick labels and smaller plotting text elements.</span>
<span class="sd">        Defaults to 10.</span>
<span class="sd">    :type detail_fontsize: int or float, passed to Draw_Scatter()</span>
<span class="sd">    :param subplot_adjust:</span>
<span class="sd">        Adjust the dimensions for drawing subplots on the Matplotlib Figure</span>
<span class="sd">        object. Passed to ``Matplotlib.subplots.subplots_adjust()``. Contains</span>
<span class="sd">        the following entries:</span>

<span class="sd">        - top: Modify the upper-most bounds of the figure.</span>
<span class="sd">        - bottom: Modify the lower-most bounds of the figure.</span>
<span class="sd">        - left: Modify the left-most bounds of the figure.</span>
<span class="sd">        - right: Modify the right-most bounds of the figure.</span>
<span class="sd">        - hspace: Modify the height of padding between subplots</span>
<span class="sd">        - wspace: Modify the width of padding between subplots</span>
<span class="sd">        - legend_pos: Two-element tuple containing floats indicating the</span>
<span class="sd">          x-axis and y-axis position of the center of the plot legend.</span>

<span class="sd">        Defaults to None.</span>

<span class="sd">    :param float fig_wspace:</span>
<span class="sd">        Modify the width of padding between subplots. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;wspace&#39;`` argument.</span>
<span class="sd">    :param float fig_hspace:</span>
<span class="sd">        Modify the height of padding between subplots. ``&#39;hspace&#39;`` argument.</span>
<span class="sd">    :param float fig_left:</span>
<span class="sd">        Modify the left-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;left&#39;`` argument.</span>
<span class="sd">    :param float fig_right:</span>
<span class="sd">        Modify the right-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;right&#39;`` argument.</span>
<span class="sd">    :param float fig_top:</span>
<span class="sd">        Modify the upper-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;top&#39;`` argument.</span>
<span class="sd">    :param float fig_bottom:</span>
<span class="sd">        Modify the lower-most bounds of the figure. Passed to</span>
<span class="sd">        ``Matplotlib.subplots.subplots_adjust()`` ``&#39;bottom&#39;`` argument.</span>
<span class="sd">    :type subplot_adjust: Seven-element tuple</span>
<span class="sd">    :param bool show_errorbars:</span>
<span class="sd">        If True, display errorbars (standard error) for normalized</span>
<span class="sd">        sensor-reference measurement pairs. Defaults to False.</span>
<span class="sd">    :param bool show_legend:</span>
<span class="sd">        If True, display the figure legend. Defaults to True.</span>
<span class="sd">    :param fig_size:</span>
<span class="sd">        The dimensions (width, height) in inches of the Matplotlib figure to</span>
<span class="sd">        be drawn. Defaults to (8, 4).</span>
<span class="sd">    :type fig_size: Two-element tuple</span>
<span class="sd">    :param int errorbar_nbins:</span>
<span class="sd">        The number of bins along the x-axis that data for the dependent variable</span>
<span class="sd">        are grouped into and displayed error bars. Defaults to 10 (i.e., 10 error</span>
<span class="sd">        bars equally spaced along the x-axis will be shown indicating the</span>
<span class="sd">        standard error in the dependent variable).</span>
<span class="sd">    :param str errorbar_color:</span>
<span class="sd">        The color of the error bars drawn on the plot. Defaults to #151515.</span>
<span class="sd">    :param legend_loc:</span>
<span class="sd">        The x and y coordinate of center of the legend (relative to the axes</span>
<span class="sd">        object coordinates).</span>
<span class="sd">    :type legend_loc: Two-element tuple</span>

<span class="sd">    Returns:</span>
<span class="sd">        ax (Matplotlib Axes object):</span>
<span class="sd">            The Matplotlib Axes object on which plotting elements</span>
<span class="sd">            will be drawn. Useful is the user is iterating over the Axes</span>
<span class="sd">            elements of a Matplotlib figure in a for-loop outside this plotting</span>
<span class="sd">            function. Within the loop, calls to this function can be made to add</span>
<span class="sd">            elements for each axes object. Returned if ``return_mpl_obj`` is</span>
<span class="sd">            True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">param_obj</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="n">param_name</span> <span class="o">=</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">name</span>
    <span class="n">fmt_param</span> <span class="o">=</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">format_name</span>
    <span class="n">fmt_param_units</span> <span class="o">=</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">units</span>

    <span class="n">met_param_obj</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">met_param</span><span class="p">)</span>
    <span class="n">met_param_name</span> <span class="o">=</span> <span class="n">met_param_obj</span><span class="o">.</span><span class="n">name</span>
    <span class="n">fmt_met_param</span> <span class="o">=</span> <span class="n">met_param_obj</span><span class="o">.</span><span class="n">format_name</span>
    <span class="n">fmt_met_units</span> <span class="o">=</span> <span class="n">met_param_obj</span><span class="o">.</span><span class="n">units</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;seaborn_style&#39;</span><span class="p">,</span> <span class="s1">&#39;darkgrid&#39;</span><span class="p">))</span>

    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;show_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;show_RMSE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;show_spearman&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;show_one_to_one&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;show_trendline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;point_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;point_size&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;point_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;point_alpha&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="n">point_colors</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;point_colors&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">xlims</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlims&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">ylims</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ylims&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">cmap_norm_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmap_norm_range&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">))</span>
    <span class="n">cmap_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cmap_name&#39;</span><span class="p">,</span> <span class="s1">&#39;Set1&#39;</span><span class="p">)</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fontsize&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
    <span class="n">detail_fontsize</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;detail_fontsize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">subplot_adjust</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subplot_adjust&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">show_errorbars</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_errorbars&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">show_legend</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;show_legend&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Remove attributes from kwargs if specified</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fontsize&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ylims&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xlims&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">met_ref_df</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;..Met data empty for </span><span class="si">{</span><span class="n">met_param_name</span><span class="si">}</span><span class="s1">, trying sensor measurements&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">avg_df</span><span class="p">[</span><span class="s1">&#39;mean_&#39;</span> <span class="o">+</span> <span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mean_&#39;</span> <span class="o">+</span> <span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">:</span>
                                                   <span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">})</span>
            <span class="n">sensor_data</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..</span><span class="si">{met_param_name}</span><span class="s1"> not measured by sensor, unable to plot &#39;</span>
                  <span class="s1">&#39;distribution&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..no intersensor averaged </span><span class="si">{met_param_name}</span><span class="s1"> data, unable to plot &#39;</span>
                  <span class="s1">&#39;distribution&#39;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="c1"># Set xlim and ylim if not specified</span>
    <span class="k">if</span> <span class="n">xlims</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">ylims</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Determine which limits need to be set based on whether values have</span>
        <span class="c1"># been passed to kwargs for xlims or ylims</span>
        <span class="n">set_xlims</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">set_ylims</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">xlims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_xlims</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">ylims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">set_ylims</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">lim_tup</span> <span class="o">=</span> <span class="n">met_scatter_lims</span><span class="p">(</span><span class="n">met_data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                   <span class="n">param</span><span class="o">=</span><span class="n">param_name</span><span class="p">,</span>
                                   <span class="n">met_param</span><span class="o">=</span><span class="n">met_param_name</span><span class="p">,</span>
                                   <span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span>
                                   <span class="n">ylims</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span>
                                   <span class="n">serials</span><span class="o">=</span><span class="n">sensor_serials</span><span class="p">,</span>
                                   <span class="n">avg_df</span><span class="o">=</span><span class="n">avg_df</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">set_xlims</span><span class="p">:</span>
            <span class="n">xlims</span> <span class="o">=</span> <span class="n">lim_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">set_ylims</span><span class="p">:</span>
            <span class="n">ylims</span> <span class="o">=</span> <span class="n">lim_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;Temp&#39;</span><span class="p">:</span>
        <span class="n">met_param_name</span> <span class="o">=</span> <span class="s1">&#39;Temp&#39;</span>
    <span class="k">if</span> <span class="n">param_name</span> <span class="o">==</span> <span class="s1">&#39;RH&#39;</span><span class="p">:</span>
        <span class="n">met_param_name</span> <span class="o">=</span> <span class="s1">&#39;RH&#39;</span>
    <span class="k">elif</span> <span class="n">met_param_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter valid parameter for met_param_name: Either Temp or RH&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">ax</span> <span class="ow">and</span> <span class="n">fig</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># No axes object passed to function, create unique fig, axes objects</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fig_size&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
        <span class="n">unique_ax_obj</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Axes object passed to function, set axes within scope of function to</span>
        <span class="c1"># passed axes object.</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span>
        <span class="n">unique_ax_obj</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Retreive formatted version of sensor and parameter name</span>
    <span class="n">fmt_sensor_name</span> <span class="o">=</span> <span class="n">sensor_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">met_ref_name</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Method&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">met_ref_name</span> <span class="o">=</span> <span class="s1">&#39;Unspecified Reference&#39;</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">met_ref_name</span> <span class="o">=</span> <span class="n">sensor_name</span>

    <span class="n">x_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">met_ref_name</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">fmt_met_param</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">fmt_met_units</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">fmt_sensor_name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">fmt_param</span> <span class="o">+</span> <span class="s1">&#39; Normalized by &#39;</span> <span class="o">+</span> <span class="n">ref_name</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">title</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">wrap_text</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">max_label_len</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xlabel&#39;</span><span class="p">:</span> <span class="n">x_label</span><span class="p">,</span>
                  <span class="s1">&#39;ylabel&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>

    <span class="c1"># Compute normalized dataframes</span>
    <span class="n">norm_df_list</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ref_df</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">ref_name</span><span class="p">)</span>

    <span class="c1"># Plot 1:1 normalization line</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#8b8b8b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.8</span><span class="p">)</span>

    <span class="c1"># Set colormap and assign number of discrete colors from colormap</span>
    <span class="k">if</span> <span class="n">point_colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="c1"># Set the colormap and configure the range of hues that will be sampled</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">monocolor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;monocolor&#39;</span><span class="p">,</span> <span class="s1">&#39;#0048AD&#39;</span><span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">monocolor</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_name</span><span class="p">)</span>
            <span class="n">cmap_lbound</span> <span class="o">=</span> <span class="n">cmap_norm_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">cmap_ubound</span> <span class="o">=</span> <span class="n">cmap_norm_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colormap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">cmap_lbound</span><span class="p">,</span> <span class="n">cmap_ubound</span><span class="p">,</span>
                      <span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">))]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">point_colors</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>

    <span class="c1"># If the normalized param is temp or RH, the ref_df will be the met_ref_df</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Temp&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;RH&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ref_df</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">ref_df</span>

    <span class="c1"># Generate scatter plots for each normalized sensor dataset</span>
    <span class="n">legend_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1:1&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sensor_n</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">norm_df_list</span><span class="p">,</span> <span class="n">sensor_serials</span><span class="p">)):</span>
        <span class="n">compare_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="n">compare_df</span><span class="p">[</span><span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span>
        <span class="n">compare_df</span><span class="p">[</span><span class="s1">&#39;Normalized_&#39;</span> <span class="o">+</span> <span class="n">param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Normalized_&#39;</span> <span class="o">+</span> <span class="n">param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span>
        <span class="n">xdata</span> <span class="o">=</span> <span class="n">compare_df</span><span class="p">[</span><span class="n">met_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span>
        <span class="n">ydata</span> <span class="o">=</span> <span class="n">compare_df</span><span class="p">[</span><span class="s1">&#39;Normalized_&#39;</span><span class="o">+</span><span class="n">param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">ydata</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">empty</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># try:</span>
        <span class="c1">#     kwargs[&#39;monocolor&#39;] = colors[i]</span>
        <span class="c1"># except IndexError:</span>
        <span class="c1">#     print(&#39;..warning: length of point colors list does not match&#39;</span>
        <span class="c1">#           &#39; number of sensor datasets&#39;)</span>
        <span class="c1">#     print(&#39;..assigning first point color to unspecified point color &#39;</span>
        <span class="c1">#           &#39;index&#39;)</span>
        <span class="c1">#     kwargs[&#39;monocolor&#39;] = colors[0]</span>

        <span class="n">draw_scatter</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">,</span>
                     <span class="n">xlims</span><span class="o">=</span><span class="n">xlims</span><span class="p">,</span> <span class="n">ylims</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span>
                     <span class="n">detail_fontsize</span><span class="o">=</span><span class="n">detail_fontsize</span><span class="p">,</span>
                     <span class="n">plot_regression</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

        <span class="c1"># Choose between serial ID and sensor number labels for plot legend</span>
        <span class="k">if</span> <span class="n">sensor_serials</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lbl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sensor_serials</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lbl</span> <span class="o">=</span> <span class="s1">&#39;Sensor &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">legend_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lbl</span><span class="p">)</span>

    <span class="c1"># Axes object position, dimensions ----------------------------------------</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sensor_serials</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">leg_cols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">col_spacing</span> <span class="o">=</span> <span class="mf">0.8</span>
        <span class="k">if</span> <span class="n">unique_ax_obj</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="o">*</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">leg_cols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">col_spacing</span> <span class="o">=</span> <span class="mf">0.8</span>
        <span class="k">if</span> <span class="n">unique_ax_obj</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.90</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>

    <span class="c1"># Set the ratio of plot dimensions to 2:1</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">xleft</span><span class="p">,</span> <span class="n">xright</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="n">ybottom</span><span class="p">,</span> <span class="n">ytop</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">xright</span><span class="o">-</span><span class="n">xleft</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ybottom</span><span class="o">-</span><span class="n">ytop</span><span class="p">))</span><span class="o">*</span><span class="n">ratio</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">ybottom</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">ytop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Adjust axes dimensions to fit width and height of plot</span>
    <span class="k">if</span> <span class="n">unique_ax_obj</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Adjustments for single plot</span>
        <span class="n">top</span> <span class="o">=</span> <span class="mf">0.9</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="mf">0.13</span>
        <span class="n">left</span> <span class="o">=</span> <span class="mf">0.04</span>
        <span class="n">right</span> <span class="o">=</span> <span class="mf">0.86</span>
        <span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.20</span>
        <span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.20</span>
        <span class="n">legend_pos</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">legend_fontsize</span> <span class="o">=</span> <span class="n">detail_fontsize</span>
        <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;center left&#39;</span>  <span class="c1"># position legend based on its center left</span>

    <span class="k">elif</span> <span class="n">subplot_adjust</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># axes adjustments for PT report formatted multi-axes plot</span>
        <span class="n">top</span> <span class="o">=</span> <span class="mf">0.95</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="mf">0.4</span>
        <span class="n">left</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="n">right</span> <span class="o">=</span> <span class="mf">0.95</span>
        <span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.20</span>
        <span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="n">legend_pos</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.65</span><span class="p">)</span>
        <span class="n">legend_fontsize</span> <span class="o">=</span> <span class="n">detail_fontsize</span>
        <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>  <span class="c1"># position the legend based on its center</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">subplot_adjust</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">subplot_adjust</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">top</span> <span class="o">=</span> <span class="n">subplot_adjust</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="n">subplot_adjust</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">left</span> <span class="o">=</span> <span class="n">subplot_adjust</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">subplot_adjust</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">hspace</span> <span class="o">=</span> <span class="n">subplot_adjust</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">wspace</span> <span class="o">=</span> <span class="n">subplot_adjust</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">legend_pos</span> <span class="o">=</span> <span class="n">subplot_adjust</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">legend_fontsize</span> <span class="o">=</span> <span class="n">detail_fontsize</span>
        <span class="n">legend_loc</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>  <span class="c1"># position the legend based on its center</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="n">wspace</span><span class="p">,</span>
                        <span class="n">hspace</span><span class="o">=</span><span class="n">hspace</span><span class="p">,</span>
                        <span class="n">left</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
                        <span class="n">right</span><span class="o">=</span><span class="n">right</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
                        <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">)</span>

    <span class="c1"># Error bars --------------------------------------------------------------</span>
    <span class="n">all_sensor_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">norm_df_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">sensor_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Normalized_&#39;</span> <span class="o">+</span> <span class="n">param_name</span>  <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span>
        <span class="n">all_sensor_data</span><span class="p">[</span><span class="n">param_name</span>  <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span> <span class="o">+</span> <span class="s1">&#39;_sensor_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">sensor_data</span>
    <span class="n">ydata</span> <span class="o">=</span> <span class="n">all_sensor_data</span>

    <span class="k">if</span> <span class="n">show_errorbars</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">error_bars</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot_yerror</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">n_xbins</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;errorbar_nbins&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                   <span class="n">errorbar_color</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;errorbar_color&#39;</span><span class="p">,</span> <span class="s1">&#39;#151515&#39;</span><span class="p">))</span>

    <span class="c1"># Legend position ---------------------------------------------------------</span>
    <span class="k">if</span> <span class="n">show_legend</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_list</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">legend_fontsize</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">,</span>
                  <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;legend_loc&#39;</span><span class="p">,</span> <span class="n">legend_pos</span><span class="p">),</span>
                  <span class="n">ncol</span><span class="o">=</span><span class="n">leg_cols</span><span class="p">,</span> <span class="n">columnspacing</span><span class="o">=</span><span class="n">col_spacing</span><span class="p">)</span>

    <span class="c1"># Write plot to file ------------------------------------------------------</span>
    <span class="k">if</span> <span class="n">write_to_file</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">todays_date</span> <span class="o">=</span> <span class="n">get_todays_date</span><span class="p">()</span>
        <span class="n">figure_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">figure_path</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span>
                            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sensor_name</span><span class="si">}</span><span class="s1">_normalized_</span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s1">_vs_</span><span class="si">{</span><span class="n">met_param_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Indicate performance targets template formatted</span>
        <span class="k">if</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">unique_ax_obj</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">figure_path</span> <span class="o">=</span> <span class="n">figure_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_vs_&#39;</span> <span class="o">+</span> <span class="n">met_param_name</span><span class="p">,</span> <span class="s1">&#39;_met&#39;</span><span class="p">)</span>
            <span class="n">figure_path</span> <span class="o">=</span> <span class="n">figure_path</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;report_fmt&#39;</span>

        <span class="c1"># Filename suffix for harmonized sensor datasets</span>
        <span class="k">if</span> <span class="n">param_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;corrected&#39;</span><span class="p">):</span>
            <span class="n">figure_path</span> <span class="o">=</span> <span class="n">figure_path</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;corrected&#39;</span>

        <span class="n">figure_path</span> <span class="o">+=</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">todays_date</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figure_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">return_mpl_obj</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">report_fmt</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ax</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, United States Environmental Protection Agency.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>