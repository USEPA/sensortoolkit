<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sensortoolkit.evaluation_objs._performance_report &mdash; sensortoolkit 0.9.0b2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            sensortoolkit
          </a>
              <div class="version">
                0.9.0b2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Setting Up for sensortoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing and Updating sensortoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../template.html">Analysis with sensortoolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../template.html#script-template">Script Template</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Objects and Data Structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../testingattrib_objects/index.html">Testing Attribute Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sdfs/index.html">sensortoolkit Data Formatting Scheme (SDFS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysis and Reports</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../evaluation_objects/index.html">Evaluation Objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">sensortoolkit API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">sensortoolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sensortoolkit.evaluation_objs._performance_report</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sensortoolkit.evaluation_objs._performance_report</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains the ``PerformanceReport`` class for constructing air</span>
<span class="sd">sensor performance evaluation reports.</span>

<span class="sd">.. important::</span>

<span class="sd">    At present, reports generated by this module utilize the **base testing**</span>
<span class="sd">    reporting templates included alongside U.S. EPA&#39;s documents detailing</span>
<span class="sd">    recommended performance protocols, metrics, and target values for PM2.5 or</span>
<span class="sd">    O3 air sensors.</span>

<span class="sd">    Future versions of sensortoolkit may allow the creation of reports for</span>
<span class="sd">    enhanced testing, however, currently programmatic creation of reports via</span>
<span class="sd">    this module is intended strictly for base testing at an ambient, outdoor</span>
<span class="sd">    monitoring site.</span>

<span class="sd">================================================================================</span>

<span class="sd">@Author:</span>
<span class="sd">  | Samuel Frederick, NSSC Contractor (ORAU)</span>
<span class="sd">  | U.S. EPA / ORD / CEMM / AMCD / SFSB</span>

<span class="sd">Created:</span>
<span class="sd">  Tue Dec 15 08:53:19 2020</span>
<span class="sd">Last Updated:</span>
<span class="sd">  Wed Feb 08 02:16:03 2023</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># Wed Feb 08 02:16:03 2023, Menaka Kumar, NSSC Contractor (ORAU) U.S. EPA / ORD / CEMM / AMCD / SFSB </span>
<span class="c1"># modified current lines 802-803 to remove &quot;org_type&quot; from appearing on PerformanceReport</span>
<span class="c1"># modified current lines 818-822 to add back &quot;org_contact_email&quot; and &quot;org_contact_phone&quot; on PerformanceReport</span>

<span class="kn">import</span> <span class="nn">pptx</span> <span class="k">as</span> <span class="nn">ppt</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">pytz</span>
<span class="kn">from</span> <span class="nn">timezonefinder</span> <span class="kn">import</span> <span class="n">TimezoneFinder</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">sensortoolkit.evaluation_objs</span> <span class="kn">import</span> <span class="n">SensorEvaluation</span>
<span class="kn">from</span> <span class="nn">sensortoolkit</span> <span class="kn">import</span> <span class="n">presets</span> <span class="k">as</span> <span class="n">_presets</span>


<div class="viewcode-block" id="PerformanceReport"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport">[docs]</a><span class="k">class</span> <span class="nc">PerformanceReport</span><span class="p">(</span><span class="n">SensorEvaluation</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate air sensor performance evaluation reports.</span>

<span class="sd">    Reports are intended for evaluations following U.S. EPA&#39;s</span>
<span class="sd">    recommendations for base testing of air sensors at outdoor ambient air</span>
<span class="sd">    monitoring sites and collocated alongside FRM/FEM monitors for use in NSIM</span>
<span class="sd">    applications.</span>

<span class="sd">    In February 2021, U.S. EPA released two reports detailing recommended</span>
<span class="sd">    performance testing protocols, metrics, and target values for the</span>
<span class="sd">    evaluation of sensors measuring either fine particulate matter (PM2.5)</span>
<span class="sd">    or ozone (O3). More detail about EPA&#39;s sensor evaluation research as well</span>
<span class="sd">    as both reports can be found online at EPA&#39;s Air Sensor Toolbox</span>
<span class="sd">    (`&lt;https://www.epa.gov/air-sensor-toolbox&gt;`_)</span>

<span class="sd">    .. important::</span>

<span class="sd">      ``PerformanceReport`` is an inherited class of ``SensorEvaluation``\. As a</span>
<span class="sd">      result, it inherits all the class and instance attributes of</span>
<span class="sd">      ``SensorEvaluation``\, including its numerous variables and data</span>
<span class="sd">      structures. Programmatically, ``PerformanceReport`` is intended as a</span>
<span class="sd">      direct extension of ``SensorEvaluation``\; users can easily interact with</span>
<span class="sd">      all the attributes and data structures for sensor evaluations. However,</span>
<span class="sd">      whereas ``SensorEvaluation`` allows analysis of a wide number of</span>
<span class="sd">      pollutants and parameters, ``PerformanceReport`` is presently intended</span>
<span class="sd">      for constructing reports pertaining to sensors measuring either fine</span>
<span class="sd">      particulate matter (PM2.5) or ozone (O3) following U.S. EPA&#39;s</span>
<span class="sd">      recommended protocols and testing metrics for evaluating these sensors.</span>
<span class="sd">      Module will exit execution if parameters other than ``&#39;PM25&#39;`` or</span>
<span class="sd">      ``&#39;O3&#39;`` are specified.</span>

<span class="sd">    Args:</span>
<span class="sd">        sensor (sensortoolkit.AirSensor object):</span>
<span class="sd">            The air sensor object containing datasets with parameter</span>
<span class="sd">            measurements that will be evaluated.</span>
<span class="sd">        param (sensortoolkit.Parameter object):</span>
<span class="sd">            The parameter (measured environmental quantity) object containing</span>
<span class="sd">            parameter-specific attributes as well as metrics and targets for</span>
<span class="sd">            evaluating sensor performance.</span>
<span class="sd">        reference (sensortoolkit.ReferenceMethod object):</span>
<span class="sd">            The FRM/FEM reference instrument object containing datasets with</span>
<span class="sd">            parameter measurements against which air sensor data will be</span>
<span class="sd">            evaluated.</span>
<span class="sd">        write_to_file (bool, optional):</span>
<span class="sd">            If true, evaluation statistics will be written to the</span>
<span class="sd">            ``/data/eval_stats`` sensor subdirectory. Figures will also be</span>
<span class="sd">            written to the appropriate figures subdirectory. Defaults to False.</span>
<span class="sd">        figure_search (bool, optional):</span>
<span class="sd">            If true, PerformanceReport will search for figures in the</span>
<span class="sd">            ``/figures`` directory before attempting to create new figures.</span>
<span class="sd">            If false, PerformanceReport will create all new figures (may risk</span>
<span class="sd">            overwriting existing figures). Defaults to False.</span>
<span class="sd">        \\*\\*kwargs (dict):</span>
<span class="sd">            - fmt_sensor_name</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Evaluation parameters for which the PerformanceReport class can</span>
    <span class="c1"># construct reports</span>
    <span class="n">report_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PM25&#39;</span><span class="p">,</span> <span class="s1">&#39;PM10&#39;</span><span class="p">,</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span> <span class="s1">&#39;SO2&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">reference</span><span class="p">,</span> <span class="n">write_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">figure_search</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># Add keyword arguments (testing_loc, testing_org, etc.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="c1"># Inherit the SensorEvaluation class instance attributes</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">sensor</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">reference</span><span class="p">,</span> <span class="n">write_to_file</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">report_params</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;Reporting template not configured for &#39;</span>
                     <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">figure_search</span> <span class="o">=</span> <span class="n">figure_search</span>

        <span class="c1"># Placeholder method for formatted sensor name, replace &#39;_&#39; with spaces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmt_sensor_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fmt_sensor_name&#39;</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">today</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">template_name</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Reporting_Template_Base_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span>
                              <span class="o">+</span> <span class="s1">&#39;.pptx&#39;</span><span class="p">)</span>
        <span class="c1"># Path to reporting template</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span>
                        <span class="s1">&#39;../templates&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">))</span>

        <span class="c1"># Details about testing and deployment site</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span> <span class="o">=</span> <span class="n">_presets</span><span class="o">.</span><span class="n">test_loc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span> <span class="o">=</span> <span class="n">_presets</span><span class="o">.</span><span class="n">test_org</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">overall_begin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_period_df</span><span class="p">[</span><span class="s1">&#39;Begin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overall_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_period_df</span><span class="p">[</span><span class="s1">&#39;End&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">utc_offset</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tzone</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">TimezoneFinder</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s1">&#39;site_lat&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s1">&#39;site_lon&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s1">&#39;site_lat&#39;</span><span class="p">])</span>
                <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s1">&#39;site_lon&#39;</span><span class="p">])</span>

                <span class="n">zone</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">timezone_at</span><span class="p">(</span><span class="n">lng</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tzone</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>

                <span class="n">lst_now</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tzone</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tzone_utc_offset</span> <span class="o">=</span> <span class="n">lst_now</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="mi">3600</span>

            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">, latitude and longitude coordinates should be passed as floats&#39;</span><span class="p">)</span>
        <span class="c1"># Populate deployment dictionary with performance metric results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_metrics</span><span class="p">()</span>

        <span class="c1"># Sampling timeframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tframe</span> <span class="o">=</span> <span class="p">{</span><span class="n">grp</span><span class="p">:</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">][</span><span class="n">grp</span><span class="p">][</span><span class="s1">&#39;eval_start&#39;</span><span class="p">]</span>
                       <span class="o">+</span> <span class="s1">&#39; to &#39;</span> <span class="o">+</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">][</span><span class="n">grp</span><span class="p">][</span><span class="s1">&#39;eval_end&#39;</span><span class="p">]</span>
                       <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                       <span class="p">}</span>

        <span class="c1"># Keys are sensor serial IDs, values are deployment group number</span>
        <span class="c1"># Useful if multiple evaluation groups deployed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]:</span>
            <span class="n">grp_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">][</span><span class="n">grp</span><span class="p">]</span>
            <span class="n">grp_sensors</span> <span class="o">=</span> <span class="n">grp_dict</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="n">grp_sensors</span><span class="p">:</span>
                <span class="n">serial</span> <span class="o">=</span> <span class="n">grp_sensors</span><span class="p">[</span><span class="n">sensor</span><span class="p">][</span><span class="s1">&#39;serial_id&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="p">[</span><span class="n">serial</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tframe</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># Initialize report object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">Presentation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shapes</span>

        <span class="c1"># Shape at background around which to orient other figures</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_element</span>

        <span class="c1"># The number of unique averaging intervals at which data will be</span>
        <span class="c1"># presented. Either param.averaging == [&#39;1-hour&#39;] (gases,</span>
        <span class="c1"># n_avg_intervals == 1) or param.averaging == [&#39;1-hour&#39;, &#39;24-hour&#39;]</span>
        <span class="c1"># (PM, n_avg_intervals == 2).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">averaging</span><span class="p">)</span>

        <span class="c1"># Initialize figure positions in report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FigPositions</span><span class="p">()</span>

        <span class="c1"># Plotting: determine the max concentration for average of concurrent</span>
        <span class="c1"># sensor measurements and also the ref max concentration. Select the</span>
        <span class="c1"># upper limit for plots as 1.25x the larger of these values.</span>
        <span class="n">sensor_avg_cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avg_hrly_df</span><span class="p">[</span><span class="s1">&#39;mean_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">ref_cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hourly_ref_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span> <span class="o">+</span> <span class="s1">&#39;_Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_cmax</span> <span class="o">=</span> <span class="mf">1.25</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">sensor_avg_cmax</span><span class="p">,</span> <span class="n">ref_cmax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_grps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="p">))</span>

        <span class="c1"># remove page 1 footnote if less than three sensors</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">shape_id</span> <span class="o">=</span> <span class="mi">57</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">shape_id</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">footnote</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                     <span class="n">shape_id</span><span class="o">=</span><span class="n">shape_id</span><span class="p">)</span>
            <span class="n">sp</span> <span class="o">=</span> <span class="n">footnote</span><span class="o">.</span><span class="n">_element</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>


            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">shape_id</span> <span class="o">=</span> <span class="mi">42</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">shape_id</span> <span class="o">=</span> <span class="mi">22</span>

            <span class="n">section_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                           <span class="n">shape_id</span><span class="o">=</span><span class="n">shape_id</span><span class="p">)</span>

            <span class="n">header_text</span> <span class="o">=</span> <span class="n">section_header</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
            <span class="n">new_text</span> <span class="o">=</span> <span class="n">header_text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Metricsï‚«&#39;</span><span class="p">,</span> <span class="s1">&#39;Metrics&#39;</span><span class="p">)</span>
            <span class="n">section_header</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">new_text</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">section_header</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span>
                            <span class="n">font_size</span><span class="o">=</span><span class="mf">17.8</span><span class="p">)</span>

<div class="viewcode-block" id="PerformanceReport.FigPositions"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.FigPositions">[docs]</a>    <span class="k">def</span> <span class="nf">FigPositions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign figure positions for reports.</span>

<span class="sd">        Values are in inches, specifying the left and top center location of</span>
<span class="sd">        each figure.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SingleScatter&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;TripleScatter&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;Timeseries&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;MetricPlot&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;MetDist&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
                         <span class="s1">&#39;MetInfl&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
                         <span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;SingleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">11.11</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;SingleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.16</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;TripleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.35</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;TripleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.82</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;Timeseries&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.63</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;Timeseries&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.15</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetricPlot&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.65</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetricPlot&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">13.19</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetDist&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.61</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetDist&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">17.58</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetInfl&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.24</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetInfl&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">17.54</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;SingleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">11.57</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;SingleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.14</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;TripleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.35</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;TripleScatter&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.82</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;Timeseries&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.63</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;Timeseries&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.19</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetricPlot&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetricPlot&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">12.78</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetDist&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.6</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetDist&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">17.3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetInfl&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.28</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;MetInfl&#39;</span><span class="p">][</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">17.31</span></div>

<div class="viewcode-block" id="PerformanceReport.FigureSearch"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.FigureSearch">[docs]</a>    <span class="k">def</span> <span class="nf">FigureSearch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure_name</span><span class="p">,</span> <span class="n">subfolder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Indicate whether a figure exists and the full path to the figure.</span>

<span class="sd">        Args:</span>
<span class="sd">            figure_name (str):</span>
<span class="sd">                The filename for the figure.</span>
<span class="sd">            subfolder (str, optional):</span>
<span class="sd">                The subdirectory within the figure path where the file is</span>
<span class="sd">                located. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (tuple): Two-element tuple containing:</span>

<span class="sd">                - **bool**: True if the figure exists, false otherwise.</span>
<span class="sd">                - **full_figure_path** (*str*): The full directory path.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">subfolder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subfolder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span>
        <span class="c1"># Search for figure created today</span>
        <span class="n">figure_name</span> <span class="o">+=</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">today</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span>
        <span class="n">full_figure_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_path</span><span class="p">,</span> <span class="n">subfolder</span><span class="p">,</span> <span class="n">figure_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">full_figure_path</span><span class="p">),</span> <span class="n">full_figure_path</span></div>

<div class="viewcode-block" id="PerformanceReport.AddFigure"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddFigure">[docs]</a>    <span class="k">def</span> <span class="nf">AddFigure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig_name</span><span class="p">,</span> <span class="n">fig_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>


<span class="sd">        Args:</span>
<span class="sd">            fig_name (TYPE): DESCRIPTION.</span>
<span class="sd">            fig_path (TYPE): DESCRIPTION.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="n">fig_name</span><span class="p">]</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_picture</span><span class="p">(</span><span class="n">fig_path</span><span class="p">,</span>
                                         <span class="n">left</span><span class="o">=</span><span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">fig_loc</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]),</span>
                                         <span class="n">top</span><span class="o">=</span><span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">fig_loc</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">])</span>
                                         <span class="p">)</span>

        <span class="c1"># Move image to 0 z-order (background)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cursor_sp</span><span class="o">.</span><span class="n">addprevious</span><span class="p">(</span><span class="n">figure</span><span class="o">.</span><span class="n">_element</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.AddSingleScatterPlot"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddSingleScatterPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AddSingleScatterPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add sensor vs reference scatter plots to report.</span>

<span class="sd">        Args:</span>
<span class="sd">            \\*\\*kwargs (dict):</span>
<span class="sd">                Keyword arguments passed to ``plot_sensor_scatter()``</span>
<span class="sd">                subroutine for drawing scatter plots.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_vs_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_desig</span> <span class="o">+</span> <span class="s1">&#39;_report_fmt&#39;</span>

        <span class="n">fig_exists</span><span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FigureSearch</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

        <span class="c1"># Draw figure if no figure exists at path or if figure_search attrib</span>
        <span class="c1"># is false</span>
        <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_search</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">create_figure</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_to_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_sensor_scatter</span><span class="p">(</span>
                <span class="n">plot_subset</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_subset&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]),</span>
                <span class="c1"># plot_limits=kwargs.get(&#39;plot_limits&#39;, (-1, self.plot_cmax)),</span>
                <span class="c1"># tick_spacing=kwargs.get(&#39;tick_spacing&#39;, 5),</span>
                <span class="c1"># text_pos=kwargs.get(&#39;text_pos&#39;, &#39;upper_left&#39;),</span>
                <span class="n">report_fmt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AddFigure</span><span class="p">(</span><span class="n">fig_name</span><span class="o">=</span><span class="s1">&#39;SingleScatter&#39;</span><span class="p">,</span> <span class="n">fig_path</span><span class="o">=</span><span class="n">fig_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.AddMultiScatter"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddMultiScatter">[docs]</a>    <span class="k">def</span> <span class="nf">AddMultiScatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Sensor vs reference scatter plots for all sensors.</span>

<span class="sd">        Args:</span>
<span class="sd">            \\*\\*kwargs (dict):</span>
<span class="sd">                Keyword arguments passed to ``plot_sensor_scatter()``</span>
<span class="sd">                subroutine for drawing scatter plots.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Use slide layout for generating additional slides</span>
        <span class="n">slide_layout_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">slide_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="n">slide_layout_idx</span><span class="p">]</span>
        <span class="c1"># Create new page</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span><span class="n">slide_layout</span><span class="p">)</span>

        <span class="c1"># Add Sensor-Sensor section header text label</span>
        <span class="n">section_header</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_textbox</span><span class="p">(</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.82</span><span class="p">),</span>  <span class="c1"># left</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">2.81</span><span class="p">),</span>  <span class="c1"># top</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.16</span><span class="p">),</span>  <span class="c1"># width</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.47</span><span class="p">))</span>  <span class="c1"># height</span>
        <span class="n">section_header_obj</span> <span class="o">=</span> <span class="n">section_header</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">section_header_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Sensor-FRM/FEM Scatter Plots&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">section_header_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                        <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

        <span class="c1"># A horizontal line separating the header text from the section body</span>
        <span class="n">hline</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_connector</span><span class="p">(</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">MSO_CONNECTOR</span><span class="o">.</span><span class="n">STRAIGHT</span><span class="p">,</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.85</span><span class="p">),</span>  <span class="c1"># start_x</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.30</span><span class="p">),</span>  <span class="c1"># start_y</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">16.24</span><span class="p">),</span>  <span class="c1"># end_x</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.30</span><span class="p">))</span>  <span class="c1"># end_y</span>

        <span class="n">hline</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
        <span class="n">hline</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">171</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">171</span><span class="p">)</span>

        <span class="c1"># Loop over averaging intervals specified for the parameter</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">averaging_interval</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">averaging</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">plural</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plural</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">fig_name</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_vs_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_desig</span> <span class="o">+</span>
                        <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">averaging_interval</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="p">)</span> <span class="o">+</span>
                        <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;sensor&#39;</span> <span class="o">+</span> <span class="n">plural</span><span class="p">)</span>

            <span class="n">fig_exists</span><span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FigureSearch</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

            <span class="c1"># Draw figure if no figure exists at path or if figure_search</span>
            <span class="c1"># attrib is false</span>
            <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_search</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fig_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">create_figure</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_to_file</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_sensor_scatter</span><span class="p">(</span>
                    <span class="n">averaging_interval</span><span class="p">,</span>
                    <span class="n">plot_limits</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plot_limits&#39;</span><span class="p">,</span>
                                           <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_cmax</span><span class="p">)),</span>
                    <span class="c1"># tick_spacing=kwargs.get(&#39;tick_spacing&#39;, 5),</span>
                    <span class="c1"># text_pos=kwargs.get(&#39;text_pos&#39;, &#39;upper_left&#39;)</span>
                    <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">scatter_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;TripleScatter&#39;</span><span class="p">]</span>
                <span class="n">fig_height</span> <span class="o">=</span> <span class="mf">5.62</span>  <span class="c1"># height of triple scatter figure in inches</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Add a page, place figure on new page</span>
                <span class="c1"># FIXME: Correct figure position needed for scatter plots with</span>
                <span class="c1"># more than three sensors.</span>
                <span class="n">scatter_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_locs</span><span class="p">[</span><span class="s1">&#39;TripleScatter&#39;</span><span class="p">]</span>

                <span class="c1"># TODO: set correct figure height for figures with mult. rows</span>
                <span class="n">fig_height</span> <span class="o">=</span> <span class="mf">5.62</span>  <span class="c1"># height of triple scatter figure in inches</span>

            <span class="n">left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">scatter_loc</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">])</span>
            <span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">scatter_loc</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="n">fig_height</span><span class="p">)</span>

            <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_picture</span><span class="p">(</span><span class="n">fig_path</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.AddTimeseriesPlot"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddTimeseriesPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AddTimeseriesPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add timeseries plots to report.</span>

<span class="sd">        Args:</span>
<span class="sd">            \\*\\*kwargs (dict):</span>
<span class="sd">                Keyword arguments passed to ``sensor_timeplot()``</span>
<span class="sd">                subroutine for drawing timeseries plots.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_timeseries_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span> \
            <span class="o">+</span> <span class="s1">&#39;_report_fmt&#39;</span>

        <span class="n">fig_exists</span><span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FigureSearch</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

        <span class="c1"># Draw figure if no figure exists at path or if figure_search</span>
        <span class="c1"># attrib is false</span>
        <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_search</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">create_figure</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_to_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">report_fmt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AddFigure</span><span class="p">(</span><span class="n">fig_name</span><span class="o">=</span><span class="s1">&#39;Timeseries&#39;</span><span class="p">,</span> <span class="n">fig_path</span><span class="o">=</span><span class="n">fig_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.AddMetricsPlot"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddMetricsPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AddMetricsPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add Performance target metric boxplots/dot plots to report.</span>

<span class="sd">        Args:</span>
<span class="sd">            \\*\\*kwargs (dict):</span>
<span class="sd">                Keyword arguments passed to ``performance_metrics()``</span>
<span class="sd">                subroutine for drawing performance metric plots.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_regression_boxplot_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span>

        <span class="n">fig_exists</span><span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FigureSearch</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

        <span class="c1"># Draw figure if no figure exists at path or if figure_search</span>
        <span class="c1"># attrib is false</span>
        <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_search</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">create_figure</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_to_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_metrics</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AddFigure</span><span class="p">(</span><span class="n">fig_name</span><span class="o">=</span><span class="s1">&#39;MetricPlot&#39;</span><span class="p">,</span> <span class="n">fig_path</span><span class="o">=</span><span class="n">fig_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.AddMetDistPlot"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddMetDistPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AddMetDistPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add meteorological distribution (Temp, RH) to report.</span>

<span class="sd">        Args:</span>
<span class="sd">            \\*\\*kwargs (dict):</span>
<span class="sd">                Keyword arguments passed to ``met_distrib()``</span>
<span class="sd">                subroutine for drawing distribution plots.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_met_distplot_report_fmt&#39;</span>

        <span class="n">fig_exists</span><span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FigureSearch</span><span class="p">(</span><span class="n">fig_name</span><span class="p">,</span> <span class="n">subfolder</span><span class="o">=</span><span class="s1">&#39;Met&#39;</span><span class="p">)</span>

        <span class="c1"># Draw figure if no figure exists at path or if figure_search</span>
        <span class="c1"># attrib is false</span>
        <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_search</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">create_figure</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_to_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_met_dist</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AddFigure</span><span class="p">(</span><span class="n">fig_name</span><span class="o">=</span><span class="s1">&#39;MetDist&#39;</span><span class="p">,</span> <span class="n">fig_path</span><span class="o">=</span><span class="n">fig_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.AddMetInflPlot"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddMetInflPlot">[docs]</a>    <span class="k">def</span> <span class="nf">AddMetInflPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add normalized met. influence scatter (Temp, RH) to report.</span>

<span class="sd">        Args:</span>
<span class="sd">            \\*\\*kwargs (dict):</span>
<span class="sd">                Keyword arguments passed to ``normalized_met_scatter()``</span>
<span class="sd">                subroutine for drawing distribution plots.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fig_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_normalized_&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span> \
            <span class="o">+</span> <span class="s1">&#39;_met_report_fmt&#39;</span>

        <span class="n">fig_exists</span><span class="p">,</span> <span class="n">fig_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FigureSearch</span><span class="p">(</span><span class="n">fig_name</span><span class="p">)</span>

        <span class="c1"># Draw figure if no figure exists at path or if figure_search</span>
        <span class="c1"># attrib is false</span>
        <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure_search</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fig_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">create_figure</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">create_figure</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_to_file</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_met_influence</span><span class="p">(</span><span class="n">report_fmt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">plot_error_bars</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AddFigure</span><span class="p">(</span><span class="n">fig_name</span><span class="o">=</span><span class="s1">&#39;MetInfl&#39;</span><span class="p">,</span> <span class="n">fig_path</span><span class="o">=</span><span class="n">fig_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.GetShape"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.GetShape">[docs]</a>    <span class="k">def</span> <span class="nf">GetShape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slide_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">slide_obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve shape object for tables based on known shape ID.</span>

<span class="sd">        Allows for editing, modifying the table and its cells.</span>

<span class="sd">        Return either based on left and top location passed in inches to</span>
<span class="sd">        function (shape_loc=(left, top)), or by passing shape index to</span>
<span class="sd">        function.</span>

<span class="sd">        Args:</span>
<span class="sd">            slide_idx (int):</span>
<span class="sd">                The index position (beginning at zero) for the slide on which</span>
<span class="sd">                the shape is located.</span>
<span class="sd">            shape_id (int, optional):</span>
<span class="sd">                An integer assigned to the shape by the powerpoint API. If not</span>
<span class="sd">                known, can pass as none, but the shape_loc should be indicated.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            shape_loc (Two-element tuple, optional):</span>
<span class="sd">                The x and y position of the top left-hand corner of the shape.</span>
<span class="sd">                The x-position is measured from the left-most part of the slide</span>
<span class="sd">                and the y-position is measured down (positive) from the</span>
<span class="sd">                topmost part of the slide. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            shape (python-pptx.Presentation.slides[slide_idx].shapes.item):</span>
<span class="sd">                The slide shape object located at the location or ID specified.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">slide_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">slide_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="n">slide_idx</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">shape_loc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">shp_l</span> <span class="o">=</span> <span class="n">shape_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">shp_t</span> <span class="o">=</span> <span class="n">shape_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="n">slide_idx</span><span class="p">]</span><span class="o">.</span><span class="n">shapes</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">inches</span><span class="p">,</span> <span class="n">shp_l</span><span class="p">,</span> <span class="n">rel_tol</span><span class="o">=</span><span class="mf">.05</span><span class="p">)</span>
                   <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">inches</span><span class="p">,</span> <span class="n">shp_t</span><span class="p">,</span> <span class="n">rel_tol</span><span class="o">=</span><span class="mf">.05</span><span class="p">)):</span>
                    <span class="k">return</span> <span class="n">shape</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No shape within specified tolerance!&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">slide_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">slide_obj</span><span class="o">.</span><span class="n">shapes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">shape</span><span class="o">.</span><span class="n">shape_id</span> <span class="o">==</span> <span class="n">shape_id</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">shape</span></div>


<div class="viewcode-block" id="PerformanceReport.EditHeader"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditHeader">[docs]</a>    <span class="k">def</span> <span class="nf">EditHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert header description (title, contact info, photo, etc.).</span>

<span class="sd">        ======================== ============ ===================</span>
<span class="sd">        Shape name               Slide Number Shape ID</span>
<span class="sd">        ======================== ============ ===================</span>
<span class="sd">        Report Title             1            35 (PM2.5), 9 (O3)</span>
<span class="sd">        Report Title             2            21 (PM2.5), 21 (O3)</span>
<span class="sd">        Report Title             3            13 (PM2.5), 15 (O3)</span>
<span class="sd">        Deployment, contact info 1            34 (PM2.5), 33 (O3)</span>
<span class="sd">        Deployment, contact info 2            20 (PM2.5), 22 (O3)</span>
<span class="sd">        Deployment, contact info 3            12 (PM2.5), 16 (O3)</span>
<span class="sd">        Photo placeholder        1            2 (PM2.5), 2 (O3)</span>
<span class="sd">        Photo placeholder        2            4 (PM2.5), 3 (O3)</span>
<span class="sd">        Photo placeholder        3            14 (PM2.5), 3 (O3)</span>
<span class="sd">        ======================== ============ ===================</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Title location for header</span>
        <span class="n">title_left</span> <span class="o">=</span> <span class="mf">0.98</span>
        <span class="n">title_top</span> <span class="o">=</span> <span class="mf">0.51</span>
        <span class="n">text_vspace</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Get pptx text shape for modifying cells</span>
        <span class="k">for</span> <span class="n">slide_n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">slide_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">slide_n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="p">,</span> <span class="n">shape_loc</span><span class="o">=</span><span class="p">(</span><span class="n">title_left</span><span class="p">,</span> <span class="n">title_top</span><span class="p">))</span>

            <span class="c1"># Set evaluation report title line 1: Parameter and test type</span>
            <span class="n">title_line_1</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">run1</span> <span class="o">=</span> <span class="n">title_line_1</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
            <span class="n">run1</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Testing Report - &#39;</span>
            <span class="n">param_baseline</span> <span class="o">=</span> <span class="n">title_line_1</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
            <span class="n">param_baseline</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">format_baseline</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;CO&#39;</span><span class="p">:</span>
                <span class="n">param_subscript</span> <span class="o">=</span> <span class="n">title_line_1</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                <span class="n">param_subscript</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">format_subscript</span>
                <span class="n">font</span> <span class="o">=</span> <span class="n">param_subscript</span><span class="o">.</span><span class="n">font</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetSubscript</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
            <span class="n">run4</span> <span class="o">=</span> <span class="n">title_line_1</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
            <span class="n">run4</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39; Base Testing&#39;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">title_line_1</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">title_line_1_font</span> <span class="o">=</span> <span class="n">title_line_1</span><span class="o">.</span><span class="n">font</span>
            <span class="n">title_line_1_font</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

            <span class="c1"># Set evaluation report title line 2: Sensor name</span>
            <span class="n">title_text_obj</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">title_text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmt_sensor_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">title_text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="n">title_font_obj</span> <span class="o">=</span> <span class="n">title_text_obj</span><span class="o">.</span><span class="n">font</span>
            <span class="n">title_font_obj</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

        <span class="c1"># Header testing information location</span>
        <span class="n">tester_left</span> <span class="o">=</span> <span class="mf">7.80</span>
        <span class="n">tester_top</span> <span class="o">=</span> <span class="mf">0.36</span>
        <span class="n">text_vspace</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="c1"># Get pptx text shape for deployment and contact information</span>
        <span class="k">for</span> <span class="n">slide_n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">slide_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">slide_n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">tester_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="p">,</span> <span class="n">shape_loc</span><span class="o">=</span><span class="p">(</span><span class="n">tester_left</span><span class="p">,</span>
                                                              <span class="n">tester_top</span><span class="p">))</span>

            <span class="c1"># Set deployment number</span>
            <span class="n">tester_text</span> <span class="o">=</span> <span class="n">tester_info</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;testing_descrip&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">tester_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

            <span class="c1"># Set testing organization name (line 2)</span>
            <span class="n">tester_text</span> <span class="o">=</span> <span class="n">tester_info</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_name&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">tester_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

            <span class="c1"># Set testing organization name (line 2)</span>
            <span class="n">tester_text</span> <span class="o">=</span> <span class="n">tester_info</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_division&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">tester_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

            <span class="c1"># Add contact email</span>
            <span class="n">tester_text</span> <span class="o">=</span> <span class="n">tester_info</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_contact_email&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">tester_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

            <span class="c1"># Add contact phone number</span>
            <span class="n">tester_text</span> <span class="o">=</span> <span class="n">tester_info</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;      &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_contact_phone&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">tester_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

            <span class="c1"># Add month(s) of eval to header</span>
            <span class="n">start_month</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_begin</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B %Y&#39;</span><span class="p">)</span>
            <span class="n">end_month</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B %Y&#39;</span><span class="p">)</span>

            <span class="n">tester_text</span> <span class="o">=</span> <span class="n">tester_info</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">start_month</span> <span class="o">==</span> <span class="n">end_month</span><span class="p">:</span>
                <span class="n">tester_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">start_month</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tester_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">start_month</span><span class="si">}</span><span class="s1">â€”</span><span class="si">{</span><span class="n">end_month</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">tester_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">tester_text</span><span class="o">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">text_vspace</span><span class="p">)</span>

        <span class="c1"># Edit header photo (edits the image placeholder)</span>
        <span class="n">pic_left</span> <span class="o">=</span> <span class="mf">12.56</span>
        <span class="n">pic_top</span> <span class="o">=</span> <span class="mf">0.29</span>
        <span class="c1"># Get pptx text shape for deployment and contact information</span>
        <span class="k">for</span> <span class="n">slide_n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">slide_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">slide_n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">pic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="p">,</span> <span class="n">shape_loc</span><span class="o">=</span><span class="p">(</span><span class="n">pic_left</span><span class="p">,</span> <span class="n">pic_top</span><span class="p">))</span>
            <span class="n">pic_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure_path</span><span class="p">,</span> <span class="s1">&#39;deployment&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pic_path</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No deployment picture found at&#39;</span><span class="p">,</span> <span class="n">pic_path</span><span class="p">)</span>
                <span class="n">placeholder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span>
                                                <span class="s1">&#39;../templates&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;placeholder_image.png&#39;</span><span class="p">)</span>
                <span class="n">placeholder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">placeholder_path</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pic</span><span class="o">.</span><span class="n">insert_picture</span><span class="p">(</span><span class="n">placeholder_path</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">pic</span><span class="o">.</span><span class="n">insert_picture</span><span class="p">(</span><span class="n">pic_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.EditSiteTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditSiteTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditSiteTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add details to testing organization and site info table (page 1).</span>

<span class="sd">        ====================== =======</span>
<span class="sd">        Table name             TableID</span>
<span class="sd">        ====================== =======</span>
<span class="sd">        Testing org, site info 18</span>
<span class="sd">        ====================== =======</span>


<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get pptx table shape for modifying cells</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

        <span class="c1"># ------------- Cell 1: Testing organization information --------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add organization name</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s2">&quot;org_name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> - &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s2">&quot;org_division&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># modified by KM 02/08/2023</span>
<span class="c1">#                         f&#39;\n{self.testing_org[&quot;org_type&quot;]}&#39;) # commented out by KM 02/08/2023</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># Add contact link</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
        <span class="n">run</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_website&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
        <span class="n">link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_website&#39;</span><span class="p">][</span><span class="s1">&#39;link&#39;</span><span class="p">]</span>
        <span class="n">hlink</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">hyperlink</span>
        <span class="n">hlink</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">link</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

        <span class="c1"># Add contact email, phone number</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span> <span class="c1"># uncommented by KM 02/08/2023</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_contact_email&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;      &#39;</span> <span class="o">+</span> <span class="c1"># uncommented by KM 02/08/2023</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">testing_org</span><span class="p">[</span><span class="s1">&#39;org_contact_phone&#39;</span><span class="p">])</span> <span class="c1"># uncommented by KM 02/08/2023</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="c1"># uncommented by KM 02/08/2023</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># uncommented by KM 02/08/2023</span>

        <span class="c1"># ----------- Cell 2: Testing location information ----------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add site name</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s1">&#39;site_name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># Add site address</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s1">&#39;site_address&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

        <span class="c1"># Add site lat long</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s2">&quot;site_lat&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s2">&quot;site_lon&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

        <span class="c1"># --------------- Cell 2: Testing location AQS ID ---------------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add site name</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">testing_loc</span><span class="p">[</span><span class="s1">&#39;site_aqs_id&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># ------------------ Cell 3: Sampling timeframe -----------------------</span>
        <span class="c1"># cell = shape.table.cell(4, 0)</span>
        <span class="c1"># text_obj = cell.text_frame.add_paragraph()</span>
        <span class="c1"># text_obj.text = f&#39;Time zone: {self.tzone.zone}&#39;</span>
        <span class="c1"># self.FormatText(text_obj, alignment=&#39;center&#39;, font_name=&#39;Calibri&#39;,</span>
        <span class="c1">#             font_size=12)</span>


        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># begin_lst = self.overall_begin.tz_convert(self.tzone.zone).strftime(&#39;%Y-%m-%d %H:%M %Z&#39;)</span>
        <span class="c1"># end_lst = self.overall_end.tz_convert(self.tzone.zone).strftime(&#39;%Y-%m-%d %H:%M %Z&#39;)</span>

        <span class="n">tstamp_fmt</span> <span class="o">=</span> <span class="s1">&#39;%m-</span><span class="si">%d</span><span class="s1">-%y&#39;</span>
        <span class="n">begin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_begin</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">tstamp_fmt</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_end</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">tstamp_fmt</span><span class="p">)</span>

        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">begin</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span></div>

        <span class="c1"># Add sampling timeframe for each group in deployment</span>
        <span class="c1"># self.eval_grps = list(self.tframe.keys())</span>
        <span class="c1"># for i, grp in enumerate(self.tframe):</span>
        <span class="c1">#     if i == 0:</span>
        <span class="c1">#         text_obj = cell.text_frame.paragraphs[0]</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         text_obj = cell.text_frame.add_paragraph()</span>
        <span class="c1">#     grp_name = self.eval_grps[i]</span>
        <span class="c1">#     grp_tframe = self.tframe[grp_name]</span>

        <span class="c1">#     if len(self.eval_grps) == 1:</span>
        <span class="c1">#         text_obj.text = grp_tframe</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         text_obj.text = grp_name + &#39;: &#39; + grp_tframe</span>
        <span class="c1">#     self.FormatText(text_obj, alignment=&#39;center&#39;, font_name=&#39;Calibri&#39;,</span>
        <span class="c1">#                     font_size=11)</span>

<div class="viewcode-block" id="PerformanceReport.EditSensorTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditSensorTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditSensorTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add information to sensor information table (page 1).</span>

<span class="sd">        =========== ===================</span>
<span class="sd">        Table name  TableID</span>
<span class="sd">        =========== ===================</span>
<span class="sd">        Sensor info 49 (PM2.5), 35 (O3)</span>
<span class="sd">        =========== ===================</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get pptx table shape for modifying cells</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">34</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>

        <span class="c1"># Populate list with configured sensor recording interval(s)</span>
        <span class="n">rec_interval</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]:</span>
            <span class="n">grp_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">][</span><span class="n">grp</span><span class="p">]</span>
            <span class="n">grp_sensors</span> <span class="o">=</span> <span class="n">grp_dict</span><span class="p">[</span><span class="s1">&#39;sensors&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="n">grp_sensors</span><span class="p">:</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="n">grp_sensors</span><span class="p">[</span><span class="n">sensor</span><span class="p">][</span><span class="s1">&#39;recording_interval&#39;</span><span class="p">]</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="n">interval</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">rec_interval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
        <span class="n">rec_interval</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rec_interval</span><span class="p">))</span>
        <span class="n">rec_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">string</span> <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">rec_interval</span><span class="p">)</span>

        <span class="c1"># ------------- Cell 1: Sensor manufacturer and model -----------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add sensor manufacturer, model name</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmt_sensor_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># --------------- Cell 2: Sensor firmware version ---------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">firmware_version</span><span class="p">:</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Add sensor manufacturer, model name</span>
            <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">firmware_version</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                            <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>


        <span class="c1"># --------------- Cell 3: Sensor recording interval -------------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add recording interval</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">rec_str</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                        <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># -------------------- Sensor Serial ID cells -------------------------</span>
        <span class="k">for</span> <span class="n">cell_n</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">iter_cells</span><span class="p">(),</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Only fill in ID info for number of sensors in evaluation.</span>
            <span class="c1"># If number of sensors is, say, 8, then the last cell for the</span>
            <span class="c1"># 3x3 grid for serial numbers is left empty.</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">cell_n</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cell_n</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cell_n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">]):</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">cell_n</span> <span class="o">&gt;</span>  <span class="mi">21</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">cell_n</span> <span class="o">&gt;</span> <span class="mi">24</span><span class="p">:</span>
                <span class="n">cell_n</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">cell_n</span> <span class="o">-=</span> <span class="mi">17</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">cell_n</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">serial_idx</span> <span class="o">=</span> <span class="n">cell_n</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">sensor_serial</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                                     <span class="p">)[</span><span class="n">serial_idx</span><span class="p">]</span>
                <span class="n">sensor_grp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                                  <span class="p">)[</span><span class="n">serial_idx</span><span class="p">]</span>

                <span class="c1"># Add group number if multiple groups</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">grp_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">grp_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">sensor_grp</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">grp_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                    <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mf">10.5</span><span class="p">)</span>

                    <span class="c1"># Add sensor serial ID</span>
                    <span class="n">serial_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">serial_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">serial_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">sensor_serial</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">serial_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mf">10.5</span><span class="p">)</span>

        <span class="c1"># If one sensor, merge 3x3 grid to single cell</span>
        <span class="c1"># if len(self.serials) == 1:</span>

        <span class="c1">#     cell_span_orig = shape.table.cell(4, 1)</span>
        <span class="c1">#     cell_span_other = shape.table.cell(6, 3)</span>

        <span class="c1">#     cell_span_orig.merge(cell_span_other)</span>

        <span class="c1"># If three or fewer sensors, merge 3x3 to 1x3 (merge to single row)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serials</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
                <span class="n">cell_span_orig</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">cell_span_other</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">cell_span_orig</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cell_span_other</span><span class="p">)</span>

        <span class="c1"># If six sensors, merge 3x3 to 2x3 (merge second and third rows)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serials</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
                <span class="n">cell_span_orig</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">cell_span_other</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
                <span class="n">cell_span_orig</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cell_span_other</span><span class="p">)</span>

        <span class="c1"># Check for issues with deployment</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]):</span>
            <span class="n">deploy_grp_data</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span>
                                               <span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="s1">&#39;sensors&#39;</span><span class="p">])</span>
            <span class="n">grp_sensors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">deploy_grp_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">grp_status</span> <span class="o">=</span> <span class="p">[</span><span class="n">deploy_grp_data</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)][</span><span class="s1">&#39;deploy_issues&#39;</span><span class="p">]</span>
                          <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">grp_sensors</span><span class="p">]</span>

            <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">grp_status</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;False&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">textobj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textobj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">textobj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;No Issues&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textobj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp</span> <span class="o">+</span> <span class="s1">&#39;: No Issues&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">textobj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">textobj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textobj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">textobj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Issues with deployment&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textobj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp</span> <span class="o">+</span> <span class="s1">&#39;: Issues with deployment&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">textobj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.EditRefTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditRefTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditRefTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add details to reference information table.</span>

<span class="sd">        ============== =======</span>
<span class="sd">        Table name     TableID</span>
<span class="sd">        ============== =======</span>
<span class="sd">        Reference info 51</span>
<span class="sd">        ============== =======</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get pptx table shape for modifying cells</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">51</span><span class="p">)</span>

        <span class="c1"># ------------- Cell 1: Sensor manufacturer and model -----------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Add reference manufacturer and model</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                        <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.EditRefConcTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditRefConcTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditRefConcTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add reference concentration tabular statistics (page 1).</span>

<span class="sd">        Located in different boxes based on the evaluation parameter type.</span>

<span class="sd">        Scatter plots box (PM2.5 only):</span>

<span class="sd">        =================== =======</span>
<span class="sd">        Table name          TableID</span>
<span class="sd">        =================== =======</span>
<span class="sd">        Reference conc info 75</span>
<span class="sd">        =================== =======</span>

<span class="sd">        Time series box (O3 only):</span>

<span class="sd">        =================== =======</span>
<span class="sd">        Table name          TableID</span>
<span class="sd">        =================== =======</span>
<span class="sd">        Reference conc info 56</span>
<span class="sd">        =================== =======</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get pptx table shape for modifying cells</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">56</span><span class="p">)</span>

        <span class="n">grp_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span>
        <span class="c1"># reference concentration range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refconc</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">grp_info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;Reference&#39;</span>
            <span class="k">try</span><span class="p">:</span>

                <span class="n">averaging</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">averaging</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;O3&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;NO2&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;CO&#39;</span><span class="p">:</span>
                    <span class="n">averaging</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;rolling_8-hour&#39;</span><span class="p">)</span>

                <span class="n">refconc_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">interval</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">averaging</span><span class="p">):</span>

                    <span class="n">ref_min</span> <span class="o">=</span> <span class="n">grp_info</span><span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">][</span><span class="n">ref</span><span class="p">][</span>
                                                                <span class="sa">f</span><span class="s1">&#39;conc_min_</span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
                    <span class="n">ref_max</span> <span class="o">=</span> <span class="n">grp_info</span><span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">][</span><span class="n">ref</span><span class="p">][</span>
                                                                <span class="sa">f</span><span class="s1">&#39;conc_max_</span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
                    <span class="n">ref_mean</span> <span class="o">=</span> <span class="n">grp_info</span><span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">][</span><span class="n">ref</span><span class="p">][</span>
                                                                <span class="sa">f</span><span class="s1">&#39;conc_mean_</span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

                    <span class="n">fmt_averaging</span> <span class="o">=</span> <span class="n">interval</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;hr&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;rolling&#39;</span><span class="p">,</span> <span class="s1">&#39;Rolling&#39;</span><span class="p">)</span>

                    <span class="n">avg_conc_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">fmt_averaging</span><span class="si">}</span><span class="s1">] </span><span class="si">{</span><span class="n">ref_min</span><span class="si">:</span><span class="s1">3.1f</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">ref_max</span><span class="si">:</span><span class="s1">3.1f</span><span class="si">}</span><span class="s1">, avg: </span><span class="si">{</span><span class="n">ref_mean</span><span class="si">:</span><span class="s1">3.1f</span><span class="si">}</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span>

                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">averaging</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                        <span class="n">avg_conc_str</span> <span class="o">=</span> <span class="n">avg_conc_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

                    <span class="n">refconc_str</span> <span class="o">+=</span> <span class="n">avg_conc_str</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">refconc</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span><span class="o">=</span><span class="n">refconc_str</span>

            <span class="c1"># Raise when attributes are &#39;none&#39; likely due to no data</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Number of periods reference exceeded concentration target</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">exceed_str</span> <span class="o">=</span> <span class="s1">&#39;n_exceed_conc_goal_24-hour&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">exceed_str</span> <span class="o">=</span> <span class="s1">&#39;n_exceed_conc_goal_1-hour&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refexceed</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">grp_info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">refexceed</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="s1">&#39;</span><span class="si">{0:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                       <span class="n">grp_info</span><span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">][</span><span class="s1">&#39;Reference&#39;</span><span class="p">][</span><span class="n">exceed_str</span><span class="p">]</span>
                       <span class="p">)</span>

            <span class="c1"># Raise when attributes are &#39;none&#39; likely due to no data</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># ------------- Cell 1: Range of ref concentrations -----------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refconc</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">grp_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refconc</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">grp_refconc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refconc</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_refconc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_name</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">grp_refconc</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

        <span class="c1"># ------------- Cell 2: N periods meeting conc. target-----------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refexceed</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">grp_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refexceed</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">grp_refexceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refexceed</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_refexceed</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_name</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">grp_refexceed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.EditMetCondTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditMetCondTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditMetCondTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add meteorological conditions table (page 1).</span>

<span class="sd">        ========================= ==================</span>
<span class="sd">        Table name                TableID</span>
<span class="sd">        ========================= ==================</span>
<span class="sd">        N outside target criteria 45 (O3), 74 (PM25)</span>
<span class="sd">        ========================= ==================</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get pptx table shape for modifying cells</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">74</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">46</span><span class="p">)</span>

        <span class="n">grp_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span>

        <span class="n">met_conds</span> <span class="o">=</span> <span class="s1">&#39;Meteorological Conditions&#39;</span>  <span class="c1"># abbreviating</span>
        <span class="k">if</span> <span class="s1">&#39;24-hour&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">averaging</span><span class="p">:</span>
            <span class="n">exceed_str</span> <span class="o">=</span> <span class="s1">&#39;n_exceed_target_criteria_24-hour&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exceed_str</span> <span class="o">=</span> <span class="s1">&#39;n_exceed_target_criteria_1-hour&#39;</span>

        <span class="c1"># Number of periods temp exceeded target criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tempexceed</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">temp</span> <span class="o">=</span> <span class="s1">&#39;Temperature&#39;</span>  <span class="c1"># abbreviating</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">grp_info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tempexceed</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grp_info</span><span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="n">met_conds</span><span class="p">][</span><span class="n">temp</span><span class="p">][</span><span class="n">exceed_str</span><span class="p">])</span>

            <span class="c1"># Raise when attributes are &#39;none&#39; likely due to no data</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tempexceed</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tempexceed</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># Number of 24-hr periods temp exceeded target criteria</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rhexceed</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">rh</span> <span class="o">=</span> <span class="s1">&#39;Relative Humidity&#39;</span>  <span class="c1"># abbreviating</span>
        <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">grp_info</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rhexceed</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grp_info</span><span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="n">met_conds</span><span class="p">][</span><span class="n">rh</span><span class="p">][</span><span class="n">exceed_str</span><span class="p">])</span>

            <span class="c1"># Raise when attributes are &#39;none&#39; likely due to no data</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rhexceed</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rhexceed</span><span class="p">[</span><span class="n">grp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="c1"># ----------- Cell 1: N periods outside temp target criteria ----------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tempexceed</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">grp_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tempexceed</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">grp_tempexceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempexceed</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>

            <span class="c1"># Gray cell</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">grp_tempexceed</span><span class="p">):</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">214</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">226</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">grp_tempexceed</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grp_tempexceed</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_tempexceed</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_name</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">grp_tempexceed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

                <span class="c1"># Modify text, add operational range</span>
                <span class="n">lbound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">operational_range</span><span class="p">[</span><span class="s1">&#39;Temp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">operational_range</span><span class="p">[</span><span class="s1">&#39;Temp&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">op_range</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lbound</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">ubound</span><span class="si">}</span><span class="s1"> Â°C&#39;</span>

                <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">new_text</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;no operational range specified&#39;</span><span class="p">,</span>
                                             <span class="n">op_range</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">new_text</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>


        <span class="c1"># ----------- Cell 2: N periods outside rh target criteria ------------</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhexceed</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
            <span class="n">grp_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rhexceed</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">grp_rhexceed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhexceed</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>

            <span class="c1"># Gray cell</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">grp_rhexceed</span><span class="p">):</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">214</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">226</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">grp_rhexceed</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">grp_rhexceed</span><span class="p">)</span>


                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_rhexceed</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp_name</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">grp_rhexceed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

                <span class="c1"># Modify text, add operational range</span>
                <span class="n">lbound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">operational_range</span><span class="p">[</span><span class="s1">&#39;RH&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">operational_range</span><span class="p">[</span><span class="s1">&#39;RH&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">op_range</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">lbound</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">ubound</span><span class="si">}</span><span class="s1">%&#39;</span>

                <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">new_text</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;no operational range specified&#39;</span><span class="p">,</span>
                                             <span class="n">op_range</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">new_text</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span></div>


<div class="viewcode-block" id="PerformanceReport.EditMetInfTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditMetInfTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditMetInfTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add meteorological influence table (page 1).</span>

<span class="sd">        ====================== ==================</span>
<span class="sd">        Table name             TableID</span>
<span class="sd">        ====================== ==================</span>
<span class="sd">        N paired met conc vals 48 (O3), 32 (PM25)</span>
<span class="sd">        ====================== ==================</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get pptx table shape for modifying cells</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetShape</span><span class="p">(</span><span class="n">slide_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape_id</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

        <span class="n">grp_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span>

        <span class="c1"># Number of 1-hr periods temp exceeded target criteria</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;Relative Humidity&#39;</span><span class="p">]</span>
        <span class="n">met_conds</span> <span class="o">=</span> <span class="s1">&#39;Meteorological Conditions&#39;</span>
        <span class="n">pair_str</span> <span class="o">=</span> <span class="s1">&#39;n_measurement_pairs_1-hour&#39;</span>

        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">grp</span><span class="p">:</span> <span class="n">grp_info</span><span class="p">[</span><span class="n">grp</span><span class="p">][</span><span class="n">met_conds</span><span class="p">][</span><span class="n">param</span><span class="p">][</span><span class="n">pair_str</span><span class="p">]</span>
                          <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">grp_info</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span>

            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]):</span>
                <span class="n">cell</span> <span class="o">=</span> <span class="n">shape</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
                <span class="n">grp_val</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">param</span><span class="p">][</span><span class="n">grp</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">grp_val</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">grp_val</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_grps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">grp_val</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">grp</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">grp_val</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.EditSensorRefTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditSensorRefTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditSensorRefTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add sensor-reference tabular statistics (page 2).</span>


<span class="sd">        Args:</span>
<span class="sd">            table (pptx table object):</span>
<span class="sd">                A table object for sensor vs. reference regression statistics.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">span_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Bias and Linearity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                         <span class="s1">&#39;Data Quality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
                         <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
                         <span class="s1">&#39;Slope&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
                         <span class="sa">f</span><span class="s1">&#39;Intercept (b)</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
                         <span class="s1">&#39;Uptime (%)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
                         <span class="s1">&#39;N pairs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">]}</span>
            <span class="n">table_categories</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Bias and Linearity&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="s1">&#39;Data Quality&#39;</span><span class="p">}</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;12&#39;</span><span class="p">:</span> <span class="s1">&#39;R^2&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;14&#39;</span><span class="p">:</span> <span class="s1">&#39;Slope&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;16&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Intercept</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;18&#39;</span><span class="p">:</span> <span class="s1">&#39;Uptime</span><span class="se">\n</span><span class="s1">(%)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;20&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of paired</span><span class="se">\n</span><span class="s1">sensor and &#39;</span>
                             <span class="s1">&#39;FRM/FEM</span><span class="se">\n</span><span class="s1">concentration values&#39;</span><span class="p">}</span>
            <span class="n">avg_intervals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;23&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;24&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;25&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;26&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;27&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;28&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;29&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;30&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;31&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;32&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">}</span>

            <span class="n">rsqr_lbound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;12&#39;</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">slope_goal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;14&#39;</span><span class="p">])[</span><span class="s1">&#39;goal&#39;</span><span class="p">]</span>
            <span class="n">slope_tol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;14&#39;</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">slope_goal</span>
            <span class="n">intcpt_lbound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;16&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">intcpt_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;16&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">metric_targets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;33&#39;</span><span class="p">:</span> <span class="s1">&#39;Metric Target Range&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;34&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¥ </span><span class="si">{:3.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rsqr_lbound</span><span class="p">),</span>
                              <span class="s1">&#39;35&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¥ </span><span class="si">{:3.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rsqr_lbound</span><span class="p">),</span>
                              <span class="s1">&#39;36&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:2.1f}</span><span class="s1"> Â± </span><span class="si">{:3.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slope_goal</span><span class="p">,</span>
                                                               <span class="n">slope_tol</span><span class="p">),</span>
                              <span class="s1">&#39;37&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:2.1f}</span><span class="s1"> Â± </span><span class="si">{:3.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slope_goal</span><span class="p">,</span>
                                                               <span class="n">slope_tol</span><span class="p">),</span>
                              <span class="s1">&#39;38&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1"> â‰¤ b â‰¤ </span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                                              <span class="n">intcpt_lbound</span><span class="p">,</span>
                                                              <span class="n">intcpt_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;39&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1"> â‰¤ b â‰¤ </span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                                              <span class="n">intcpt_lbound</span><span class="p">,</span>
                                                              <span class="n">intcpt_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;40&#39;</span><span class="p">:</span> <span class="s1">&#39;75%*&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;41&#39;</span><span class="p">:</span> <span class="s1">&#39;75%*&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;42&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;43&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">span_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Bias and Linearity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                         <span class="s1">&#39;Data Quality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>
            <span class="n">table_categories</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Bias and Linearity&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="s1">&#39;Data Quality&#39;</span><span class="p">}</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="s1">&#39;R^2&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="s1">&#39;Slope&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Intercept</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;Uptime</span><span class="se">\n</span><span class="s1">(%)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;11&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of paired</span><span class="se">\n</span><span class="s1">sensor and &#39;</span>
                             <span class="s1">&#39;reference</span><span class="se">\n</span><span class="s1">concentration values&#39;</span><span class="p">}</span>
            <span class="n">avg_intervals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;13&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;14&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;15&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;16&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;17&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">}</span>

            <span class="n">rsqr_lbound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;7&#39;</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">slope_goal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;8&#39;</span><span class="p">])[</span><span class="s1">&#39;goal&#39;</span><span class="p">]</span>
            <span class="n">slope_tol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;8&#39;</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">slope_goal</span>
            <span class="n">intcpt_lbound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">intcpt_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;9&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">metric_targets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;18&#39;</span><span class="p">:</span> <span class="s1">&#39;Metric Target Range&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;19&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¥ </span><span class="si">{:3.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rsqr_lbound</span><span class="p">),</span>
                              <span class="s1">&#39;20&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:2.1f}</span><span class="s1"> Â± </span><span class="si">{:3.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slope_goal</span><span class="p">,</span>
                                                               <span class="n">slope_tol</span><span class="p">),</span>
                              <span class="s1">&#39;21&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1"> â‰¤ b â‰¤ </span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                                              <span class="n">intcpt_lbound</span><span class="p">,</span>
                                                              <span class="n">intcpt_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;22&#39;</span><span class="p">:</span> <span class="s1">&#39;75%*&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;23&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">grp_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetSpanningCells</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">span_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c1_row</span><span class="p">,</span> <span class="n">c2_row</span><span class="p">,</span> <span class="n">c3_row</span><span class="p">,</span> <span class="n">c4_row</span><span class="p">,</span> <span class="n">c5_row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="n">h_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_stats</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;Averaging Interval&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1-hour&#39;</span>
                            <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="p">(</span><span class="n">c1_row</span><span class="p">,</span> <span class="n">c2_row</span><span class="p">,</span> <span class="n">c3_row</span><span class="p">,</span> <span class="n">c4_row</span><span class="p">,</span> <span class="n">c5_row</span><span class="p">,</span> <span class="n">c6_row</span><span class="p">,</span> <span class="n">c7_row</span><span class="p">,</span> <span class="n">c8_row</span><span class="p">,</span>
             <span class="n">c9_row</span><span class="p">,</span> <span class="n">c10_row</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">h_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_stats</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;Averaging Interval&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1-hour&#39;</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">d_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_stats</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;Averaging Interval&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;24-hour&#39;</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Sensor group dictionary, reset group keys for indexing</span>
        <span class="n">grp_df</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span>
                                  <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grp_name</span><span class="p">][</span><span class="s1">&#39;sensors&#39;</span><span class="p">])</span>
        <span class="n">grp_df</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">grp_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">grp_df</span><span class="o">.</span><span class="n">keys</span><span class="p">()))}</span>

        <span class="c1"># Lists for storing metric values to compute mean across sensors</span>
        <span class="n">rsqr_h_vals</span><span class="p">,</span> <span class="n">rsqr_d_vals</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">slope_h_vals</span><span class="p">,</span> <span class="n">slope_d_vals</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">intcpt_h_vals</span><span class="p">,</span> <span class="n">intcpt_d_vals</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uptime_h_vals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">uptime_d_vals</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">n_h_vals</span><span class="p">,</span> <span class="n">n_d_vals</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="n">n_header_rows</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">datacols</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">datacols</span> <span class="o">=</span> <span class="mi">11</span>
        <span class="n">datacell0</span> <span class="o">=</span> <span class="n">datacols</span><span class="o">*</span><span class="n">n_header_rows</span>
        <span class="n">datacellend</span> <span class="o">=</span> <span class="n">datacell0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span><span class="o">*</span><span class="n">datacols</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Add table header info (rows 1-4)</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">table_categories</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">table_categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
                <span class="n">font_obj</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">font</span>
                <span class="n">font_obj</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                <span class="n">metric</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>

                <span class="c1"># Format the superscript for R^2</span>
                <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;R^2&#39;</span><span class="p">:</span>
                    <span class="n">baseline</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">baseline</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>
                    <span class="n">superscript</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">superscript</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="n">superscript</span><span class="o">.</span><span class="n">font</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetSuperscript</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
                <span class="c1"># Format superscript for intercept if units in ug/m^3</span>
                <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;Intercept</span><span class="se">\n</span><span class="s1">(Î¼g/m^3)&#39;</span><span class="p">:</span>
                    <span class="n">lineone</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">lineone</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Intercept</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">linetwo_baseline_one</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">linetwo_baseline_one</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;(Î¼g/m&#39;</span>
                    <span class="n">superscript</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">superscript</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="n">superscript</span><span class="o">.</span><span class="n">font</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetSuperscript</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
                    <span class="n">linetwo_baseline_two</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">linetwo_baseline_two</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;)&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metric_targets</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metric_targets</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">avg_intervals</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">avg_intervals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">datacell0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span><span class="o">*</span><span class="n">datacols</span><span class="p">:</span>
                <span class="c1"># Row of avg values at bottom of table</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Mean&#39;</span>

            <span class="c1"># Add Sensor Serial IDs to column 1</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">datacell0</span>
               <span class="ow">and</span> <span class="n">c1_row</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Sensor &#39;</span> <span class="o">+</span> <span class="n">grp_df</span><span class="p">[</span><span class="n">c1_row</span><span class="p">][</span><span class="s1">&#39;serial_id&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="p">(</span><span class="n">datacell0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Decision tree for adding sensor data to table</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">datacell0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">datacell0</span> <span class="o">+</span> <span class="p">(</span><span class="n">datacols</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span>
               <span class="ow">and</span> <span class="n">i</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>

                <span class="c1"># Metric column 1</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># 1-hr R^2</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">h_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c1_row</span><span class="p">,</span> <span class="s1">&#39;R$^2$&#39;</span><span class="p">]</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                        <span class="n">rsqr_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                        <span class="k">pass</span>
                    <span class="n">c1_row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Metric column 2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># 1-hr slope</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">h_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c2_row</span><span class="p">,</span> <span class="s1">&#39;Slope&#39;</span><span class="p">]</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                            <span class="n">slope_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="c1"># 24-hr R^2</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">d_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c2_row</span><span class="p">,</span> <span class="s1">&#39;R$^2$&#39;</span><span class="p">]</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                            <span class="n">rsqr_d_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

                        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                        <span class="k">pass</span>
                    <span class="n">c2_row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Metric column 3</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># 1-hr Intercept</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">h_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c3_row</span><span class="p">,</span> <span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                            <span class="n">intcpt_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="c1"># 1-hr Slope</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">h_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c3_row</span><span class="p">,</span> <span class="s1">&#39;Slope&#39;</span><span class="p">]</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                            <span class="n">slope_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                        <span class="k">pass</span>
                    <span class="n">c3_row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Metric column 4</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># insert Uptime</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># 1-hr uptime</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">grp_df</span><span class="p">[</span><span class="n">c4_row</span><span class="p">][</span><span class="s1">&#39;uptime_1-hour&#39;</span><span class="p">]</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">uptime_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="c1"># 24-hr Slope</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">d_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c4_row</span><span class="p">,</span> <span class="s1">&#39;Slope&#39;</span><span class="p">]</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                            <span class="n">slope_d_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                        <span class="k">pass</span>
                    <span class="n">c4_row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Metric column 5</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># insert N paired sensor/reference values</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># 1-hr N</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">h_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c5_row</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>
                            <span class="n">n_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="c1"># 1-hr Intercept</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">h_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c5_row</span><span class="p">,</span> <span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
                            <span class="n">intcpt_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                        <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                        <span class="k">pass</span>
                    <span class="n">c5_row</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Columns 6-10 only in PM2.5 sensor-reference table</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

                    <span class="c1"># Metric column 6</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># 24-hr Intercept</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">d_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c6_row</span><span class="p">,</span> <span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
                            <span class="n">intcpt_d_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                            <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                            <span class="k">pass</span>
                        <span class="n">c6_row</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Metric column 7</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># 1-hr Uptime</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">grp_df</span><span class="p">[</span><span class="n">c7_row</span><span class="p">][</span><span class="s1">&#39;uptime_1-hour&#39;</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">uptime_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>
                            <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                            <span class="k">pass</span>
                        <span class="n">c7_row</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Metric column 8</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># 24-hr Uptime</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">grp_df</span><span class="p">[</span><span class="n">c8_row</span><span class="p">][</span><span class="s1">&#39;uptime_24-hour&#39;</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">uptime_d_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>
                            <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                            <span class="k">pass</span>
                        <span class="n">c8_row</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Metric column 9</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># 1-hr N</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">h_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c9_row</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span>
                            <span class="n">n_h_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>
                            <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                            <span class="k">pass</span>
                        <span class="n">c9_row</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="c1"># Metric column 10</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># 24-hr N</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">d_stats</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">c10_row</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">]</span>
                            <span class="n">n_d_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>
                            <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Condition for empty grp stats</span>
                            <span class="k">pass</span>
                        <span class="n">c10_row</span> <span class="o">+=</span> <span class="mi">1</span>


            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">datacellend</span> <span class="o">-</span> <span class="n">datacols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">datacellend</span> <span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># 1-hr R^2</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">rsqr_h_vals</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;R^2&#39;</span><span class="p">)</span>
                    <span class="c1"># 1-hr R^2</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">rsqr_h_vals</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;R^2&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># 1-hr Slope</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">slope_h_vals</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Slope&#39;</span><span class="p">)</span>
                    <span class="c1"># 24-hr R^2</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">rsqr_d_vals</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;R^2&#39;</span><span class="p">)</span>

                <span class="c1"># Metric Mean column 3</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># 1-hr Intercept</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">intcpt_h_vals</span><span class="p">,</span>
                                                <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Intercept&#39;</span><span class="p">)</span>
                    <span class="c1"># 1-hr Slope</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">slope_h_vals</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Slope&#39;</span><span class="p">)</span>

                <span class="c1"># Metric Mean column 4</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># 1-hr Uptime</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uptime_h_vals</span><span class="p">,</span>
                                                <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Uptime&#39;</span><span class="p">)</span>
                    <span class="c1"># 24-hr Slope</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">slope_d_vals</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Slope&#39;</span><span class="p">)</span>

                <span class="c1"># Metric Mean column 5</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># 1-hr N paired measurements</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="c1"># 1-hr Intercept</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">intcpt_h_vals</span><span class="p">,</span>
                                                <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Intercept&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># 24-hr Intercept</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">intcpt_d_vals</span><span class="p">,</span>
                                                <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Intercept&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># 1-hr Uptime</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uptime_h_vals</span><span class="p">,</span>
                                                <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Uptime&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># 24-hr Uptime</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uptime_d_vals</span><span class="p">,</span>
                                                <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;Uptime&#39;</span><span class="p">)</span>

                <span class="c1"># Indicate number of sensors meeting performance metric target</span>
                <span class="k">if</span> <span class="n">txt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">trgt_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">datacols</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                    <span class="n">trgt_cell_text</span> <span class="o">=</span> <span class="n">trgt_cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
                    <span class="n">trgt_cell_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">txt</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">trgt_cell_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                    <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

            <span class="c1">#if i &gt; datacellend and self.n_sensors &gt; 1:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">datacellend</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="p">(</span><span class="n">datacellend</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Metric Mean column 1</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Mean 1-hr R^2</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rsqr_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(rsqr_h_vals, metric=&#39;R^2&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                    <span class="c1"># Mean 1-hr R^2</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rsqr_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(rsqr_h_vals, metric=&#39;R^2&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>

                <span class="c1"># Metric Mean column 2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Mean 1-hr Slope</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">slope_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(slope_h_vals, metric=&#39;Slope&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                    <span class="c1"># Mean 24-hr R^2</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rsqr_d_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(rsqr_d_vals, metric=&#39;R^2&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>

                <span class="c1"># Metric Mean column 3</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Mean 1-hr Intercept</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">intcpt_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(intcpt_h_vals,</span>
                        <span class="c1">#                        metric=&#39;Intercept&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                    <span class="c1"># Mean 1-hr Slope</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">slope_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(slope_h_vals, metric=&#39;Slope&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>

                <span class="c1"># Metric Mean column 4</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Mean 1-hr Uptime</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uptime_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(self.uptime_h_vals,</span>
                        <span class="c1">#                        metric=&#39;Uptime&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>
                    <span class="c1"># Mean 24-hr Slope</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">slope_d_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(slope_d_vals, metric=&#39;Slope&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>

                <span class="c1"># Metric Mean column 5</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Mean 1-hr N paired measurements</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n_h_vals</span><span class="p">)</span>
                    <span class="c1"># Mean 1-hr Intercept</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">intcpt_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(intcpt_h_vals,</span>
                        <span class="c1">#                         metric=&#39;Intercept&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># Metric Mean column 6</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># Mean 24-hr Intercept</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">intcpt_d_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(intcpt_d_vals,</span>
                        <span class="c1">#                        metric=&#39;Intercept&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;3.2f&#39;</span>

                    <span class="c1"># Metric Mean column 7</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">6</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># Mean 1-hr Uptime</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uptime_h_vals</span><span class="p">)</span>
                        <span class="c1">#txt = self.CheckTargets(self.uptime_h_vals,</span>
                        <span class="c1">#                        metric=&#39;Uptime&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>

                    <span class="c1"># Metric Mean column 8</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># Mean 24-hr Uptime</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uptime_d_vals</span><span class="p">)</span>
                        <span class="c1"># txt = self.CheckTargets(self.uptime_d_vals,</span>
                        <span class="c1">#                         metric=&#39;Uptime&#39;)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>

                    <span class="c1"># Metric Mean column 9</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># Mean 1-hr N paired measurements</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n_h_vals</span><span class="p">)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>

                    <span class="c1"># Metric Mean column 10</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">9</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># Mean 24-hr N paired measurements</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">n_d_vals</span><span class="p">)</span>
                        <span class="n">fmt_precision</span> <span class="o">=</span> <span class="s1">&#39;.0f&#39;</span>

                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">fmt_precision</span><span class="p">)</span>

            <span class="c1"># Configure text formatting</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.EditErrorTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditErrorTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditErrorTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add error tabular statistics (page 2).</span>


<span class="sd">        Args:</span>
<span class="sd">            table (pptx table object):</span>
<span class="sd">                A table object for sensor vs. reference error (RMSE, NRMSE).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">error_stats</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span>
                                       <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grp_name</span><span class="p">]</span>
                                       <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">]</span>
                                       <span class="p">[</span><span class="s1">&#39;Error&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">error_stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">error_stats</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">datacols</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">nheaderrows</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">headercellend</span> <span class="o">=</span> <span class="n">nheaderrows</span><span class="o">*</span><span class="p">(</span><span class="n">datacols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">span_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                         <span class="sa">f</span><span class="s1">&#39;RMSE</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
                         <span class="s1">&#39;NRMSE</span><span class="se">\n</span><span class="s1">(%)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]}</span>
            <span class="n">table_categories</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Error&#39;</span><span class="p">}</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;RMSE</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="s1">&#39;NRMSE</span><span class="se">\n</span><span class="s1">(%)&#39;</span><span class="p">}</span>
            <span class="n">avg_intervals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;11&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;12&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;13&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;14&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">}</span>

            <span class="n">rmse_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nrmse_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;8&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">metric_targets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;15&#39;</span><span class="p">:</span> <span class="s1">&#39;Metric Target Range&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;16&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤  </span><span class="si">{:2.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rmse_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;17&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:2.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rmse_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;18&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nrmse_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;19&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nrmse_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;20&#39;</span><span class="p">:</span> <span class="s1">&#39;Deployment Value&#39;</span><span class="p">}</span>
            <span class="n">metric_vals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;21&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">error_stats</span><span class="p">[</span><span class="s1">&#39;rmse_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;22&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">error_stats</span><span class="p">[</span><span class="s1">&#39;rmse_24-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;23&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">error_stats</span><span class="p">[</span><span class="s1">&#39;nrmse_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;24&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">error_stats</span><span class="p">[</span><span class="s1">&#39;nrmse_24-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">)}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metric_vals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;-999.00&#39;</span><span class="p">:</span>
                    <span class="n">metric_vals</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">datacols</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">nheaderrows</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">headercellend</span> <span class="o">=</span> <span class="n">nheaderrows</span><span class="o">*</span><span class="p">(</span><span class="n">datacols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">span_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Error&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
            <span class="n">table_categories</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Error&#39;</span><span class="p">}</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;RMSE</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">}</span>
            <span class="n">avg_intervals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">}</span>

            <span class="n">rmse_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                                      <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">metric_targets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="s1">&#39;Metric Target Range&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:2.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rmse_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="s1">&#39;Deployment Value&#39;</span><span class="p">}</span>
            <span class="n">metric_vals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">error_stats</span><span class="p">[</span><span class="s1">&#39;rmse_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">)}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metric_vals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;-999.00&#39;</span><span class="p">:</span>
                    <span class="n">metric_vals</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetSpanningCells</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">span_dict</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">table_categories</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">table_categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
                <span class="n">font_obj</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">font</span>
                <span class="n">font_obj</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                <span class="n">metric</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>

                <span class="c1"># TODO: Possibly remove since using unicode chars?</span>
                <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;RMSE</span><span class="se">\n</span><span class="s1">(Î¼g/m^3)&#39;</span><span class="p">:</span>
                    <span class="n">lineone</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">lineone</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;RMSE</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">linetwo_baseline_one</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">linetwo_baseline_one</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;(Î¼g/m&#39;</span>
                    <span class="n">superscript</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">superscript</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="n">superscript</span><span class="o">.</span><span class="n">font</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetSuperscript</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
                    <span class="n">linetwo_baseline_two</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">linetwo_baseline_two</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;)&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metric_targets</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metric_targets</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">avg_intervals</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">avg_intervals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metric_vals</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>

            <span class="c1"># Metric column 1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">headercellend</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Mean 1-hr RMSE</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;RMSE&#39;</span><span class="p">)</span>
                    <span class="c1"># Mean 1-hr RMSE</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;RMSE&#39;</span><span class="p">)</span>
                <span class="c1"># Metric column 2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># 1-hr NRMSE</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;NRMSE&#39;</span><span class="p">)</span>
                    <span class="c1"># 24-hr RMSE</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;RMSE&#39;</span><span class="p">)</span>
                <span class="c1"># Metric column 3</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="c1"># 1-hr NRMSE</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;NRMSE&#39;</span><span class="p">)</span>
                    <span class="c1"># Metric column 4</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="c1"># 24-hr NRMSE</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;NRMSE&#39;</span><span class="p">)</span>

                <span class="c1"># Indicate whether sensors meet performance metric target</span>
                <span class="k">if</span> <span class="n">txt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">trgt_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">datacols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                    <span class="n">trgt_cell_text</span> <span class="o">=</span> <span class="n">trgt_cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
                    <span class="n">trgt_cell_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">txt</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">trgt_cell_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                    <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

            <span class="n">txt</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PerformanceReport.EditSensorSensorTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditSensorSensorTable">[docs]</a>    <span class="k">def</span> <span class="nf">EditSensorSensorTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">slide</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add intersensor (sensor-sensor) precision tabular stats (page 2).</span>


<span class="sd">        Args:</span>
<span class="sd">            table (pptx table object):</span>
<span class="sd">                A table object for intersensor precision statistics.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">grp_stats</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_dict</span><span class="p">[</span><span class="s1">&#39;Deployment Groups&#39;</span><span class="p">]</span>
                                     <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grp_name</span><span class="p">]</span>
                                     <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">]</span>
                                     <span class="p">[</span><span class="s1">&#39;Precision&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">datacols</span> <span class="o">=</span> <span class="mi">6</span>
            <span class="n">nheaderrows</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">headercellend</span> <span class="o">=</span> <span class="n">nheaderrows</span><span class="o">*</span><span class="p">(</span><span class="n">datacols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">span_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Precision (between collocated sensors)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                         <span class="s1">&#39;Data Quality&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                         <span class="s1">&#39;CV</span><span class="se">\n</span><span class="s1">(%)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                         <span class="sa">f</span><span class="s1">&#39;SD</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
                         <span class="s1">&#39;Number concurrent sensor values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]}</span>
            <span class="n">table_categories</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Precision (between collocated sensors)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="s1">&#39;Data Quality&#39;</span><span class="p">}</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;8&#39;</span><span class="p">:</span> <span class="s1">&#39;CV</span><span class="se">\n</span><span class="s1">(%)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;SD</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;12&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of concurrent</span><span class="se">\n</span><span class="s1">sensor concentration pairs&#39;</span><span class="p">}</span>
            <span class="n">avg_intervals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;15&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;16&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;17&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;18&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;19&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;20&#39;</span><span class="p">:</span> <span class="s1">&#39;24-Hour&#39;</span><span class="p">}</span>

            <span class="n">cv_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                            <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;8&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sd_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                            <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;10&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">metric_targets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;21&#39;</span><span class="p">:</span> <span class="s1">&#39;Metric Target Range&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;22&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cv_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;23&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cv_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;24&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:2.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sd_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;25&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:2.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sd_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;26&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;27&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;28&#39;</span><span class="p">:</span> <span class="s1">&#39;Deployment Value&#39;</span><span class="p">}</span>
            <span class="n">metric_vals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;29&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;cv_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;30&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;cv_24-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;31&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;std_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;32&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;std_24-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;33&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;n_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;.0f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;34&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;n_24-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;.0f&#39;</span><span class="p">)}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">datacols</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">nheaderrows</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="n">headercellend</span> <span class="o">=</span> <span class="n">nheaderrows</span><span class="o">*</span><span class="p">(</span><span class="n">datacols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">span_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Precision (between collocated sensors)&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                         <span class="c1">#&#39;Data Quality&#39;: [3, 4],</span>
                         <span class="p">}</span>

            <span class="n">table_categories</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;Precision (between collocated sensors)&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="s1">&#39;Data Quality&#39;</span><span class="p">}</span>
            <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="s1">&#39;CV</span><span class="se">\n</span><span class="s1">(%)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;SD</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;7&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of paired</span><span class="se">\n</span><span class="s1">sensor and &#39;</span>
                            <span class="s1">&#39;reference</span><span class="se">\n</span><span class="s1">concentration values&#39;</span><span class="p">}</span>
            <span class="n">avg_intervals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;9&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;10&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;11&#39;</span><span class="p">:</span> <span class="s1">&#39;1-Hour&#39;</span><span class="p">}</span>

            <span class="n">cv_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                            <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;5&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">sd_ubound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span>
                            <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="s1">&#39;bounds&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">metric_targets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;12&#39;</span><span class="p">:</span> <span class="s1">&#39;Metric Target Range&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;13&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:3.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cv_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;14&#39;</span><span class="p">:</span> <span class="s1">&#39;â‰¤ </span><span class="si">{:2.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sd_ubound</span><span class="p">),</span>
                              <span class="s1">&#39;15&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;16&#39;</span><span class="p">:</span> <span class="s1">&#39;Deployment Value&#39;</span><span class="p">}</span>
            <span class="n">metric_vals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;17&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;cv_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;18&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;std_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;3.1f&#39;</span><span class="p">),</span>
                           <span class="s1">&#39;19&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">(</span><span class="n">grp_stats</span><span class="p">[</span><span class="s1">&#39;n_1-hour&#39;</span><span class="p">],</span> <span class="s1">&#39;.0f&#39;</span><span class="p">)}</span>

        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetSpanningCells</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">span_dict</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells</span><span class="p">):</span>
            <span class="n">text_obj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">table_categories</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">table_categories</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
                <span class="n">font_obj</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">font</span>
                <span class="n">font_obj</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
                <span class="n">metric</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>

                <span class="c1"># TODO: Possibly remove since using unicode chars?</span>
                <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;SD</span><span class="se">\n</span><span class="s1">(Î¼g/m^3)&#39;</span><span class="p">:</span>
                    <span class="n">lineone</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">lineone</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;SD</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">linetwo_baseline_one</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">linetwo_baseline_one</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;(Î¼g/m&#39;</span>
                    <span class="n">superscript</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">superscript</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
                    <span class="n">font</span> <span class="o">=</span> <span class="n">superscript</span><span class="o">.</span><span class="n">font</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">SetSuperscript</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
                    <span class="n">linetwo_baseline_two</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                    <span class="n">linetwo_baseline_two</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;)&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metric_targets</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metric_targets</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">avg_intervals</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">avg_intervals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">metric_vals</span><span class="p">:</span>
                <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>

            <span class="c1"># Metric column 1</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">headercellend</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">headercellend</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Mean 1-hr CV</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;CV&#39;</span><span class="p">)</span>
                    <span class="c1"># Mean 1-hr CV</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;CV&#39;</span><span class="p">)</span>
                <span class="c1"># Metric column 2</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># 1-hr Std dev</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;SD&#39;</span><span class="p">)</span>
                    <span class="c1"># 24-hr CV</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;CV&#39;</span><span class="p">)</span>
                <span class="c1"># Metric column 3</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># 1-hr Std dev</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;CV&#39;</span><span class="p">)</span>
                <span class="c1"># Metric column 4</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">datacols</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="c1"># 24-hr Std dev</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                        <span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckTargets</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;SD&#39;</span><span class="p">)</span>

                <span class="c1"># Indicate whether sensors meet performance metric target</span>
                <span class="k">if</span> <span class="n">txt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">trgt_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">datacols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                    <span class="n">trgt_cell_text</span> <span class="o">=</span> <span class="n">trgt_cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
                    <span class="n">trgt_cell_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">txt</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">trgt_cell_text</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                    <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

                <span class="c1"># Gray cell</span>
                <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="n">text_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">214</span><span class="p">,</span>
                                                                      <span class="mi">216</span><span class="p">,</span>
                                                                      <span class="mi">226</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

            <span class="n">txt</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">footnote</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_textbox</span><span class="p">(</span>
                                    <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.32</span><span class="p">),</span>  <span class="c1"># left</span>
                                    <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">14.43</span><span class="p">),</span>  <span class="c1"># top</span>
                                    <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">9.4</span><span class="p">),</span>  <span class="c1"># width</span>
                                    <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.48</span><span class="p">))</span>  <span class="c1"># height</span>
            <span class="n">text_frame</span> <span class="o">=</span> <span class="n">footnote</span><span class="o">.</span><span class="n">text_frame</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">footnote_superscript</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
            <span class="n">footnote_superscript</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="n">font</span> <span class="o">=</span> <span class="n">footnote_superscript</span><span class="o">.</span><span class="n">font</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetSuperscript</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>

            <span class="n">footnote</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
            <span class="n">footnote</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Precision statistics are computed for evaluations with &#39;</span>
                      <span class="s1">&#39;at least three collocated sensor units. Metric values &#39;</span>
                      <span class="s1">&#39;are left blank for evaluations with two or fewer sensor &#39;</span>
                      <span class="s1">&#39;units.&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            <span class="n">text_frame</span><span class="o">.</span><span class="n">fit_text</span><span class="p">()</span></div>



<div class="viewcode-block" id="PerformanceReport.SetSpanningCells"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.SetSpanningCells">[docs]</a>    <span class="k">def</span> <span class="nf">SetSpanningCells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">span_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge tabular cells to form cells spanning multiple rows/columns.</span>


<span class="sd">        Args:</span>
<span class="sd">            table (pptx.table.Table):</span>
<span class="sd">                pptx table object to modify.</span>
<span class="sd">            span_dict (dict):</span>
<span class="sd">                Dictionary where each entry contains list of</span>
<span class="sd">                consecutive cell indices in the table that will be spanned.</span>

<span class="sd">                Example:</span>
<span class="sd">                    Say you have a table with three rows and two columns for</span>
<span class="sd">                    a total of 4 cells. Let&#39;s say we want to make the first</span>
<span class="sd">                    row of cells into a single cell that spans the row. The</span>
<span class="sd">                    cells in the table are accessed by the index position</span>
<span class="sd">                    starting at zero in the top left corner and incrementing</span>
<span class="sd">                    from left to right. The table and the indicies for each</span>
<span class="sd">                    cell can be visualized in the following way:</span>

<span class="sd">                    +---+---+---+</span>
<span class="sd">                    | 0 | 1 | 2 |</span>
<span class="sd">                    +---+---+---+</span>
<span class="sd">                    | 3 | 4 | 5 |</span>
<span class="sd">                    +---+---+---+</span>

<span class="sd">                    Since we want to span the columns of the first row, we need</span>
<span class="sd">                    to indicate in the span_dict that the starting cell for</span>
<span class="sd">                    spanning the table is the cell at index position zero and the</span>
<span class="sd">                    ending cell for spanning will be the cell at index position</span>
<span class="sd">                    two.</span>

<span class="sd">                    &gt;&gt;&gt;span_dict = {&#39;name_of_spanned_cells&#39;: [0, 2]}</span>

<span class="sd">                    The spanned table will then be returned as:</span>

<span class="sd">                    +---+---+---+</span>
<span class="sd">                    |           |</span>
<span class="sd">                    +---+---+---+</span>
<span class="sd">                    |   |   |   |</span>
<span class="sd">                    +---+---+---+</span>

<span class="sd">        Returns:</span>
<span class="sd">            cells (collection of pptx.table.Table.cell objects):</span>
<span class="sd">                Table cells that have been spanned.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cells</span> <span class="o">=</span> <span class="p">[</span><span class="n">cell</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">iter_cells</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">span_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">span_dict</span><span class="p">:</span>
                <span class="n">merge_start_idx</span> <span class="o">=</span> <span class="n">span_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">merge_end_idx</span> <span class="o">=</span> <span class="n">span_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">merge_start_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">merge_start_idx</span><span class="p">]</span>
                <span class="n">merge_end_cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">merge_end_idx</span><span class="p">]</span>
                <span class="n">merge_start_cell</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merge_end_cell</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cells</span></div>

<div class="viewcode-block" id="PerformanceReport.EditTabularStats"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.EditTabularStats">[docs]</a>    <span class="k">def</span> <span class="nf">EditTabularStats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for constructing tables and adding entries (page 2).</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>


        <span class="c1"># Use slide layout for generating additional slides</span>
        <span class="n">tabular_layout_idx</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">tabular_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="n">tabular_layout_idx</span><span class="p">]</span>

        <span class="n">uptime_disclaimer</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;*This value is only a recommendation for &#39;</span>
                             <span class="s1">&#39;ensuring data quality and is not included in the &#39;</span>
                             <span class="s1">&#39;list of target values discussed in Section 4 of &#39;</span>
                             <span class="s1">&#39;the Performance Testing Protocols, Metrics, and &#39;</span>
                             <span class="s1">&#39;Target Values for Fine Particulate Matter Air &#39;</span>
                             <span class="s1">&#39;Sensors</span><span class="se">\n</span><span class="s1">document.&#39;</span><span class="p">)</span>

        <span class="n">legend_txt</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;line1&#39;</span><span class="p">:</span> <span class="s1">&#39;Device-specific metrics (computed for each &#39;</span>
                         <span class="s1">&#39;sensor in evaluation)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line2&#39;</span><span class="p">:</span> <span class="s1">&#39;â—‹â—‹â—‹	Metric value for none of devices tested &#39;</span>
                         <span class="s1">&#39;falls within the target range&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line3&#39;</span><span class="p">:</span> <span class="s1">&#39;â—â—‹â—‹	Metric value for one of devices tested &#39;</span>
                         <span class="s1">&#39;falls within the target range&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line4&#39;</span><span class="p">:</span> <span class="s1">&#39;â—â—â—‹   Metric value for two of devices tested &#39;</span>
                         <span class="s1">&#39;falls within the target range&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line5&#39;</span><span class="p">:</span> <span class="s1">&#39;â—â—â—   Metric value for three of devices tested &#39;</span>
                         <span class="s1">&#39;falls within the target range&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line6&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line7&#39;</span><span class="p">:</span> <span class="s1">&#39;Single-valued metrics &#39;</span>
                         <span class="s1">&#39;(computed via entire evaluation dataset)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line8&#39;</span><span class="p">:</span> <span class="s1">&#39;â˜†  Indicates that the metric value is not &#39;</span>
                         <span class="s1">&#39;within the target range&#39;</span><span class="p">,</span>
                <span class="s1">&#39;line9&#39;</span><span class="p">:</span> <span class="s1">&#39;â˜…  Indicates that the metric value is within &#39;</span>
                         <span class="s1">&#39;the target range&#39;</span><span class="p">,</span>

                <span class="p">}</span>


        <span class="c1"># List of unique testing groups</span>
        <span class="n">grps</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>

        <span class="k">for</span> <span class="n">grp_n</span><span class="p">,</span> <span class="n">grp_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grps</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">serial_grp_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">grp_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grp_name</span> <span class="o">=</span> <span class="n">grp_name</span>

            <span class="c1"># Create new tabular stats page</span>
            <span class="n">tabular_slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">add_slide</span><span class="p">(</span>
                                                <span class="n">tabular_layout</span><span class="p">)</span>


            <span class="n">uptime_footnote</span> <span class="o">=</span> <span class="n">tabular_slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_textbox</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.51</span><span class="p">),</span>
                                                               <span class="n">top</span><span class="o">=</span><span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">21.52</span><span class="p">),</span>
                                                               <span class="n">width</span><span class="o">=</span><span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">15.68</span><span class="p">),</span>
                                                               <span class="n">height</span><span class="o">=</span><span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.48</span><span class="p">))</span>
            <span class="n">uptime_textframe</span> <span class="o">=</span> <span class="n">uptime_footnote</span><span class="o">.</span><span class="n">text_frame</span>

            <span class="n">uptime_p</span> <span class="o">=</span> <span class="n">uptime_textframe</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">uptime_p</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">uptime_disclaimer</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">uptime_p</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mf">11.5</span><span class="p">)</span>

            <span class="c1"># Sensor Reference Table</span>
            <span class="n">sr_frame</span><span class="p">,</span> <span class="n">sr_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConstructTable</span><span class="p">(</span>
                                        <span class="n">tabular_slide</span><span class="p">,</span>
                                        <span class="n">table_type</span><span class="o">=</span><span class="s1">&#39;sensor_reference&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EditSensorRefTable</span><span class="p">(</span><span class="n">sr_table</span><span class="p">)</span>

            <span class="c1"># Error Table</span>
            <span class="n">e_frame</span><span class="p">,</span> <span class="n">e_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConstructTable</span><span class="p">(</span>
                                        <span class="n">tabular_slide</span><span class="p">,</span>
                                        <span class="n">table_type</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EditErrorTable</span><span class="p">(</span><span class="n">e_table</span><span class="p">)</span>

            <span class="c1"># Intersensor (sensor-sensor) table</span>
            <span class="n">ss_frame</span><span class="p">,</span> <span class="n">ss_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ConstructTable</span><span class="p">(</span>
                                        <span class="n">tabular_slide</span><span class="p">,</span>
                                        <span class="n">table_type</span><span class="o">=</span><span class="s1">&#39;sensor_sensor&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EditSensorSensorTable</span><span class="p">(</span><span class="n">ss_table</span><span class="p">,</span> <span class="n">tabular_slide</span><span class="p">)</span>

            <span class="c1"># Adjust sensor-reference table vertical position</span>
            <span class="n">EMU_to_in</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">914400.0</span>
            <span class="n">sr_top</span> <span class="o">=</span> <span class="mf">4.03</span>  <span class="c1"># in</span>
            <span class="n">sr_height</span> <span class="o">=</span> <span class="n">EMU_to_in</span><span class="o">*</span><span class="n">sr_frame</span><span class="o">.</span><span class="n">height</span>
            <span class="n">sr_frame</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">sr_top</span><span class="p">)</span>

            <span class="c1"># Adjust error table vertical position</span>
            <span class="n">e_t</span> <span class="o">=</span> <span class="mf">4.03</span> <span class="o">+</span> <span class="n">sr_height</span> <span class="o">+</span> <span class="mf">0.4</span>  <span class="c1"># in</span>
            <span class="n">e_h</span> <span class="o">=</span> <span class="n">EMU_to_in</span><span class="o">*</span><span class="n">e_frame</span><span class="o">.</span><span class="n">height</span>
            <span class="n">e_frame</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">e_t</span><span class="p">)</span>

            <span class="c1"># Adjust Sensor-Sensor table vertical position</span>
            <span class="n">ss_top</span> <span class="o">=</span> <span class="n">e_t</span> <span class="o">+</span> <span class="n">e_h</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.4</span>  <span class="c1"># in</span>
            <span class="n">ss_frame</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">ss_top</span><span class="p">)</span>

            <span class="c1"># Add section header</span>
            <span class="n">tabular_header</span> <span class="o">=</span> <span class="n">tabular_slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_textbox</span><span class="p">(</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.82</span><span class="p">),</span>  <span class="c1"># left</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">2.81</span><span class="p">),</span>  <span class="c1"># top</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.16</span><span class="p">),</span>  <span class="c1"># width</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.47</span><span class="p">))</span>  <span class="c1"># height</span>
            <span class="n">tabular_header_obj</span> <span class="o">=</span> <span class="n">tabular_header</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">tabular_header_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Tabular Statistics&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_grps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">tabular_header_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">+=</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_name</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">tabular_header_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

            <span class="c1"># Add Sensor-Reference section header text label</span>
            <span class="n">sr_header</span> <span class="o">=</span> <span class="n">tabular_slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_textbox</span><span class="p">(</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.82</span><span class="p">),</span>  <span class="c1"># left</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.30</span><span class="p">),</span>  <span class="c1"># top</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">12.81</span><span class="p">),</span>  <span class="c1"># width</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.44</span><span class="p">))</span>  <span class="c1"># height</span>
            <span class="n">sr_header_obj</span> <span class="o">=</span> <span class="n">sr_header</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sr_header_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Sensor-FRM/FEM Correlation&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">sr_header_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

            <span class="c1"># Add Sensor-Sensor section header text label</span>
            <span class="n">ss_header</span> <span class="o">=</span> <span class="n">tabular_slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_textbox</span><span class="p">(</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.82</span><span class="p">),</span>  <span class="c1"># left</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">e_t</span> <span class="o">+</span> <span class="n">e_h</span> <span class="o">+</span> <span class="mf">0.12</span><span class="p">),</span>  <span class="c1"># top</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">12.81</span><span class="p">),</span>  <span class="c1"># width</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.44</span><span class="p">))</span>  <span class="c1"># height</span>
            <span class="n">ss_header_obj</span> <span class="o">=</span> <span class="n">ss_header</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


            <span class="n">ss_header_text</span> <span class="o">=</span> <span class="n">ss_header_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
            <span class="n">ss_header_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Sensor-Sensor Precision&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">footnote_superscript</span> <span class="o">=</span> <span class="n">ss_header_obj</span><span class="o">.</span><span class="n">add_run</span><span class="p">()</span>
                <span class="n">footnote_superscript</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
                <span class="n">font</span> <span class="o">=</span> <span class="n">footnote_superscript</span><span class="o">.</span><span class="n">font</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SetSuperscript</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">ss_header_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri Light&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

            <span class="n">connector1</span> <span class="o">=</span> <span class="n">tabular_slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_connector</span><span class="p">(</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">MSO_CONNECTOR</span><span class="o">.</span><span class="n">STRAIGHT</span><span class="p">,</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.85</span><span class="p">),</span>  <span class="c1"># start_x</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.30</span><span class="p">),</span>  <span class="c1"># start_y</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">16.24</span><span class="p">),</span>  <span class="c1"># end_x</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.30</span><span class="p">))</span>  <span class="c1"># end_y</span>

            <span class="n">connector1</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">connector1</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">171</span><span class="p">,</span>
                                                                         <span class="mi">171</span><span class="p">,</span>
                                                                         <span class="mi">171</span><span class="p">)</span>

            <span class="n">connector2</span> <span class="o">=</span> <span class="n">tabular_slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_connector</span><span class="p">(</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">MSO_CONNECTOR</span><span class="o">.</span><span class="n">STRAIGHT</span><span class="p">,</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.85</span><span class="p">),</span>  <span class="c1"># start_x</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">e_t</span> <span class="o">+</span> <span class="n">e_h</span> <span class="o">+</span> <span class="mf">0.56</span><span class="p">),</span>  <span class="c1"># start_y</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">16.24</span><span class="p">),</span>  <span class="c1"># end_x</span>
                            <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">e_t</span> <span class="o">+</span> <span class="n">e_h</span> <span class="o">+</span> <span class="mf">0.56</span><span class="p">))</span>  <span class="c1"># end_y</span>

            <span class="n">connector2</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">connector2</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">171</span><span class="p">,</span>
                                                                         <span class="mi">171</span><span class="p">,</span>
                                                                         <span class="mi">171</span><span class="p">)</span>

            <span class="c1"># Add Sensor-Sensor text label</span>
            <span class="n">legend_h</span> <span class="o">=</span> <span class="mf">2.7</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="n">tabular_slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">MSO_SHAPE</span><span class="o">.</span><span class="n">ROUNDED_RECTANGLE</span><span class="p">,</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">8.83</span><span class="p">),</span>  <span class="c1"># left</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">e_t</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">e_h</span> <span class="o">+</span> <span class="o">-</span> <span class="n">legend_h</span><span class="p">)),</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">6.69</span><span class="p">),</span>  <span class="c1"># width</span>
                                <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">legend_h</span><span class="p">))</span>

            <span class="n">legend</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">236</span><span class="p">,</span>
                                                                <span class="mi">236</span><span class="p">,</span>
                                                                <span class="mi">240</span><span class="p">)</span>

            <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">214</span><span class="p">,</span>
                                                                     <span class="mi">216</span><span class="p">,</span>
                                                                     <span class="mi">226</span><span class="p">)</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>

            <span class="n">legend_obj</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">legend_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">legend_txt</span><span class="p">[</span><span class="s1">&#39;line1&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FormatText</span><span class="p">(</span><span class="n">legend_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                            <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">legend_txt</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">legend_obj</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span>
                    <span class="n">legend_obj</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">legend_txt</span><span class="p">[</span><span class="n">line</span><span class="p">]</span>

                <span class="n">font</span> <span class="o">=</span> <span class="n">legend_obj</span><span class="o">.</span><span class="n">font</span>
                <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Calibri&#39;</span>
                <span class="n">font</span><span class="o">.</span><span class="n">Bold</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;line6&#39;</span><span class="p">:</span>
                    <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.ConstructTable"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.ConstructTable">[docs]</a>    <span class="k">def</span> <span class="nf">ConstructTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slide</span><span class="p">,</span> <span class="n">table_type</span><span class="o">=</span><span class="s1">&#39;sensor_reference&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select and construct tables on report page 2.</span>

<span class="sd">        Presets are set for constructing each table type (number of rows and</span>
<span class="sd">        columns, dimensions of tables, shading of cells and fill color, etc.)</span>

<span class="sd">        Args:</span>
<span class="sd">            slide (pptx slide object):</span>
<span class="sd">                The report slide on which the tabular statistics will be</span>
<span class="sd">                placed. This will likely be slide #2 (i.e.,</span>
<span class="sd">                ``self.rpt.slides[1]``\).</span>
<span class="sd">            table_type (str):</span>
<span class="sd">                Name of the type of table to construct. Options include the</span>
<span class="sd">                following:</span>

<span class="sd">                    - ``&#39;sensor_reference&#39;``</span>
<span class="sd">                    - ``&#39;error&#39;``</span>
<span class="sd">                    - ``&#39;sensor_sensor&#39;``</span>

<span class="sd">        Returns:</span>
<span class="sd">            (tuple): Two-element tuple containing:</span>

<span class="sd">                - **frame** (*pptx GraphicFrame*): Object in which the table</span>
<span class="sd">                  is contained.</span>
<span class="sd">                - **table** (*pptx table shape*): Table shape formatted for</span>
<span class="sd">                  the selected table type.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cell_margin</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="n">table_spacing</span> <span class="o">=</span> <span class="mf">0.4</span>
        <span class="n">shapes</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span>

        <span class="c1"># Create Sensor-Reference Correlation Table ---------------------------</span>
        <span class="k">if</span> <span class="n">table_type</span> <span class="o">==</span> <span class="s1">&#39;sensor_reference&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">nrows</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="mi">11</span>
                <span class="n">col_width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.2</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">14.4</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.07</span> <span class="o">+</span> <span class="mf">0.45</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.32</span><span class="p">)</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.69</span><span class="p">)</span>
                <span class="c1"># grey out cells at index (from l-r where top left is 0)</span>
                <span class="n">greyed_cells</span> <span class="o">=</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">nrows</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="mi">6</span>
                <span class="n">col_width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">2.4</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">14.4</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.07</span> <span class="o">+</span> <span class="mf">0.45</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">grp_n_sensors</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.32</span><span class="p">)</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.69</span><span class="p">)</span>
                <span class="n">greyed_cells</span> <span class="o">=</span> <span class="p">[</span><span class="mi">23</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">table_type</span> <span class="o">==</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="n">col_width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.2</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">7.2</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.23</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.32</span><span class="p">)</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.69</span> <span class="o">+</span> <span class="mf">7.83</span> <span class="o">+</span> <span class="n">table_spacing</span><span class="p">)</span>
                <span class="n">greyed_cells</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">col_width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">2.4</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">7.2</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.23</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.32</span><span class="p">)</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.69</span> <span class="o">+</span> <span class="mf">7.83</span> <span class="o">+</span> <span class="n">table_spacing</span><span class="p">)</span>
                <span class="n">greyed_cells</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">table_type</span> <span class="o">==</span> <span class="s1">&#39;sensor_sensor&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="mi">7</span>
                <span class="n">col_width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.2</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">12.0</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.23</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.32</span><span class="p">)</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.69</span> <span class="o">+</span> <span class="mf">7.83</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">table_spacing</span> <span class="o">+</span> <span class="mf">3.23</span><span class="p">)</span>
                <span class="n">greyed_cells</span> <span class="o">=</span> <span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_avg_intervals</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span>
                <span class="n">ncols</span> <span class="o">=</span> <span class="mi">4</span>
                <span class="n">col_width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">2.4</span><span class="p">)</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">12.0</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.23</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.32</span><span class="p">)</span>
                <span class="n">top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">3.69</span> <span class="o">+</span> <span class="mf">7.83</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">table_spacing</span> <span class="o">+</span> <span class="mf">3.23</span><span class="p">)</span>
                <span class="n">greyed_cells</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">]</span>

        <span class="c1"># Construct the table based on selected presets</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span>
                                 <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">table</span>
        <span class="n">table</span><span class="o">.</span><span class="n">horz_banding</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Loop over the cells in the table, configure fill color, cell margins</span>
        <span class="k">for</span> <span class="n">cell_idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">iter_cells</span><span class="p">()):</span>
            <span class="c1"># Set cell border width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetCellBorder</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

            <span class="c1"># Set dark blue cell fill color</span>
            <span class="k">if</span> <span class="n">cell_idx</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">*</span><span class="n">ncols</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">cell_idx</span> <span class="o">%</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">191</span><span class="p">,</span>
                                                                  <span class="mi">208</span><span class="p">,</span>
                                                                  <span class="mi">235</span><span class="p">)</span>
            <span class="c1"># Set transparent (background) fill for top 3 cells</span>
            <span class="k">if</span> <span class="n">cell_idx</span> <span class="o">%</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">cell_idx</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">*</span><span class="n">ncols</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">background</span><span class="p">()</span>

            <span class="c1"># Grey out cells where no target range specified</span>
            <span class="k">if</span> <span class="n">greyed_cells</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cell_idx</span> <span class="ow">in</span> <span class="n">greyed_cells</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">solid</span><span class="p">()</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">fore_color</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">dml</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">RGBColor</span><span class="p">(</span><span class="mi">214</span><span class="p">,</span>
                                                                      <span class="mi">216</span><span class="p">,</span>
                                                                      <span class="mi">226</span><span class="p">)</span>
            <span class="c1"># Set cell margins to near zero</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">margin_left</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">cell_margin</span><span class="p">)</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">margin_right</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">cell_margin</span><span class="p">)</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">margin_top</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">cell_margin</span><span class="p">)</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">margin_bottom</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="n">cell_margin</span><span class="p">)</span>
            <span class="c1"># Vertical position text in middle of cells</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">vertical_anchor</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">MSO_ANCHOR</span><span class="o">.</span><span class="n">MIDDLE</span>

            <span class="k">for</span> <span class="n">paragraph</span> <span class="ow">in</span> <span class="n">cell</span><span class="o">.</span><span class="n">text_frame</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">paragraph</span><span class="o">.</span><span class="n">runs</span><span class="p">:</span>
                    <span class="n">run</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>

        <span class="c1"># Modify table column width</span>
        <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">2.2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col_idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
            <span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">col_idx</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">col_width</span>

        <span class="c1"># Modify table header row height</span>
        <span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.47</span><span class="p">)</span>  <span class="c1"># Category</span>
        <span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.97</span><span class="p">)</span>  <span class="c1"># Metric label</span>
        <span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.72</span><span class="p">)</span>  <span class="c1"># Averaging interval</span>
        <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">)):</span>
            <span class="n">table</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">row_idx</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Inches</span><span class="p">(</span><span class="mf">0.45</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">frame</span><span class="p">,</span> <span class="n">table</span></div>

<div class="viewcode-block" id="PerformanceReport.PrintpptxShapes"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.PrintpptxShapes">[docs]</a>    <span class="k">def</span> <span class="nf">PrintpptxShapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slide_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Diagnostic tool for indicating shape ids and locations on reporting</span>
<span class="sd">        template slides.</span>

<span class="sd">        Args:</span>
<span class="sd">            slide number (int):</span>
<span class="sd">                The number of the slide (starting at 1) for which shape ids and</span>
<span class="sd">                locations will be printed.</span>
<span class="sd">            shape_type (str) {&#39;all&#39;, ...?}:</span>
<span class="sd">                The types of shapes on the slide to print out. &#39;all&#39; will</span>
<span class="sd">                return all shapes regardless of type, however, selecting a</span>
<span class="sd">                particular type (e.g., &#39;table&#39;) will only return shapes on the</span>
<span class="sd">                page corresponding to the specified type.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:^6s}{:^18s}{:^12s}{:^10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span>
                                                   <span class="s1">&#39;Left loc&#39;</span><span class="p">,</span> <span class="s1">&#39;Top loc&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:^6s}{:^18s}{:^12s}{:^10s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;(in)&#39;</span><span class="p">,</span> <span class="s1">&#39;(in)&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:^45s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">45</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">shape_type</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="n">slide_number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shapes</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%4s</span><span class="s2"> </span><span class="si">%16s</span><span class="s2"> </span><span class="si">%10.2f</span><span class="s2"> </span><span class="si">%10.2f</span><span class="s2">&quot;</span> <span class="o">%</span>
                      <span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">shape_id</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">shape_type</span><span class="p">,</span>
                       <span class="n">shape</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">inches</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">inches</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="n">slide_number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shapes</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">shape_type</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">shape_type</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%4s</span><span class="s2"> </span><span class="si">%16s</span><span class="s2"> </span><span class="si">%10.2f</span><span class="s2"> </span><span class="si">%10.2f</span><span class="s2">&quot;</span> <span class="o">%</span>
                          <span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">shape_id</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">shape_type</span><span class="p">,</span>
                           <span class="n">shape</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">inches</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">inches</span><span class="p">))</span></div>

<div class="viewcode-block" id="PerformanceReport.SubElement"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.SubElement">[docs]</a>    <span class="k">def</span> <span class="nf">SubElement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">tagname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify an XML element by adding a sub-element entry and assign</span>
<span class="sd">        attributes.</span>

<span class="sd">        **Reference:**</span>

<span class="sd">            Based on Steve Canny&#39;s code at the following link:</span>

<span class="sd">            https://groups.google.com/g/python-pptx/c/UTkdemIZICw</span>

<span class="sd">        Args:</span>
<span class="sd">            parent (XML element):</span>
<span class="sd">                An XML element.</span>
<span class="sd">            tagname (str):</span>
<span class="sd">                XML tagname for the sub-element to add to the parent attribute.</span>
<span class="sd">            \\*\\*kwargs (dict): Attributes to assign to the sub-element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            element (XML): Updated element with attributes added.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Create a new sub-element entry for the passed tagname</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">oxml</span><span class="o">.</span><span class="n">xmlchemy</span><span class="o">.</span><span class="n">OxmlElement</span><span class="p">(</span><span class="n">tagname</span><span class="p">)</span>

        <span class="c1"># Add attributes to the new element entry</span>
        <span class="n">element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Join the XML sub-element to the parent element</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">element</span></div>

<div class="viewcode-block" id="PerformanceReport.SetCellBorder"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.SetCellBorder">[docs]</a>    <span class="k">def</span> <span class="nf">SetCellBorder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">border_color</span><span class="o">=</span><span class="s2">&quot;ffffff&quot;</span><span class="p">,</span> <span class="n">border_width</span><span class="o">=</span><span class="s1">&#39;20000&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Edit tabular cell boarder attributes (border width, fill color,</span>
<span class="sd">        etc.).</span>

<span class="sd">        **Reference:**</span>

<span class="sd">            Based on Steve Canny&#39;s code at the following links:</span>

<span class="sd">            - https://groups.google.com/g/python-pptx/c/UTkdemIZICw</span>
<span class="sd">            - https://stackoverflow.com/questions/42610829/python-pptx-changing-table-style-or-adding-borders-to-cells</span>


<span class="sd">        Args:</span>
<span class="sd">            cell (pptx table._cell object):</span>
<span class="sd">                The cell object within a pptx.table object that will be edited.</span>
<span class="sd">            border_color (str, optional):</span>
<span class="sd">                Cell border color in hex color code. Defaults to &quot;ffffff&quot;</span>
<span class="sd">                (white).</span>
<span class="sd">            border_width (str, optional):</span>
<span class="sd">                The width of the cell border (in english metric units).</span>
<span class="sd">                Defaults to &#39;20000&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Table cell object</span>
        <span class="n">tc</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">_tc</span>
        <span class="c1"># Table cell properties</span>
        <span class="n">tcPr</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">get_or_add_tcPr</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">lines</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a:lnL&#39;</span><span class="p">,</span> <span class="s1">&#39;a:lnR&#39;</span><span class="p">,</span> <span class="s1">&#39;a:lnT&#39;</span><span class="p">,</span> <span class="s1">&#39;a:lnB&#39;</span><span class="p">]:</span>
            <span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">tcPr</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">border_width</span><span class="p">,</span>
                                 <span class="n">cap</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="n">mpd</span><span class="o">=</span><span class="s1">&#39;sng&#39;</span><span class="p">,</span> <span class="n">algn</span><span class="o">=</span><span class="s1">&#39;ctr&#39;</span><span class="p">)</span>
            <span class="n">solidFill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="s1">&#39;a:solidFill&#39;</span><span class="p">)</span>
            <span class="n">srgbClr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">solidFill</span><span class="p">,</span> <span class="s1">&#39;a:srgbClr&#39;</span><span class="p">,</span>
                                      <span class="n">val</span><span class="o">=</span><span class="n">border_color</span><span class="p">)</span>
            <span class="n">prstDash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="s1">&#39;a:prstDash&#39;</span><span class="p">,</span>
                                       <span class="n">val</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
            <span class="n">round_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="s1">&#39;a:round&#39;</span><span class="p">)</span>
            <span class="n">headEnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="s1">&#39;a:headEnd&#39;</span><span class="p">,</span>
                                      <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="s1">&#39;med&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="s1">&#39;med&#39;</span><span class="p">)</span>
            <span class="n">tailEnd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span> <span class="s1">&#39;a:tailEnd&#39;</span><span class="p">,</span>
                                      <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="s1">&#39;med&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="s1">&#39;med&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.SetSubscript"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.SetSubscript">[docs]</a>    <span class="k">def</span> <span class="nf">SetSubscript</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Workaround for making font object text subscript (not included in</span>
<span class="sd">        python-pptx as of v0.6.19)</span>

<span class="sd">        **Reference:**</span>

<span class="sd">            Code via Martin Packer:</span>

<span class="sd">            https://stackoverflow.com/questions/61329224/how-do-i-add-superscript-subscript-text-to-powerpoint-using-python-pptx</span>


<span class="sd">        Args:</span>
<span class="sd">            font (pptx text run object):</span>
<span class="sd">                Font object containing various character properties.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">font</span><span class="o">.</span><span class="n">_element</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;-25000&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.SetSuperscript"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.SetSuperscript">[docs]</a>    <span class="k">def</span> <span class="nf">SetSuperscript</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Workaround for making font object text superscript (not included in</span>
<span class="sd">        python-pptx as of v0.6.19)</span>

<span class="sd">        **Reference:**</span>

<span class="sd">            Code via Martin Packer:</span>

<span class="sd">            https://stackoverflow.com/questions/61329224/how-do-i-add-superscript-subscript-text-to-powerpoint-using-python-pptx</span>

<span class="sd">        Args:</span>
<span class="sd">            font (pptx text run object):</span>
<span class="sd">                Font object containing various character properties.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">font</span><span class="o">.</span><span class="n">_element</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;30000&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.MoveSlide"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.MoveSlide">[docs]</a>    <span class="k">def</span> <span class="nf">MoveSlide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slides</span><span class="p">,</span> <span class="n">slide</span><span class="p">,</span> <span class="n">new_idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move the supplemental info table to the last slide position.</span>

<span class="sd">        **Reference:**</span>

<span class="sd">            Code via github user Amazinzay (Feb 17 2021):</span>

<span class="sd">            https://github.com/scanny/python-pptx/issues/68</span>

<span class="sd">        Args:</span>
<span class="sd">            slides (pptx.slide.Slides):</span>
<span class="sd">                The collection of presentation slide objects.</span>
<span class="sd">            slide (pptx.slide.Slide):</span>
<span class="sd">                The slide object that will be reordered.</span>
<span class="sd">            new_idx (int):</span>
<span class="sd">                The integer position indicating where the slide will be</span>
<span class="sd">                relocated.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">slides</span><span class="o">.</span><span class="n">_sldIdLst</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">new_idx</span><span class="p">,</span> <span class="n">slides</span><span class="o">.</span><span class="n">_sldIdLst</span><span class="p">[</span><span class="n">slides</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">slide</span><span class="p">)])</span></div>

<div class="viewcode-block" id="PerformanceReport.AddSlideNumbers"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.AddSlideNumbers">[docs]</a>    <span class="k">def</span> <span class="nf">AddSlideNumbers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add slide numbers to slides generated during report construction.</span>

<span class="sd">        For some reason, the python pptx module can&#39;t assign the footer page</span>
<span class="sd">        number to slides that are created by the library. While slides that</span>
<span class="sd">        are imported via the template (the first and last page of the report)</span>
<span class="sd">        have page number placeholders already assigned, the pptx library does not</span>
<span class="sd">        do this without explicitly copying and pasting the page number</span>
<span class="sd">        placeholder from the layout to the slides that are created by the</span>
<span class="sd">        module.</span>

<span class="sd">        **Reference:**</span>

<span class="sd">            This code follows the basic outline Steve Canny (scanny) suggests</span>
<span class="sd">            in response to this GitHub post:</span>

<span class="sd">                https://github.com/scanny/python-pptx/issues/64</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slide_layouts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">placeholders</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">placeholders</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">placeholder</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">placeholders</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">layout</span><span class="o">.</span><span class="n">placeholders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Slide Number Placeholder&#39;</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># add slide numbers to the 2nd through the 2nd to last slide</span>
        <span class="c1"># (slides that are generated by PerformanceReport)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">slide</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="o">.</span><span class="n">clone_placeholder</span><span class="p">(</span><span class="n">placeholder</span><span class="p">)</span>
            <span class="n">slide_placeholder</span> <span class="o">=</span> <span class="n">slide</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">slide_placeholder</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="PerformanceReport.FormatText"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.FormatText">[docs]</a>    <span class="k">def</span> <span class="nf">FormatText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_obj</span><span class="p">,</span> <span class="n">alignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">font_name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
                   <span class="n">font_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set text attributes (font, size, bold, italic, alignment).</span>

<span class="sd">        Args:</span>
<span class="sd">            text_obj (pptx.text.text Subshape):</span>
<span class="sd">                Object containing the text attributes.</span>
<span class="sd">            alignment (str, optional):</span>
<span class="sd">                Text alignment. Options are &#39;center&#39; or &#39;left&#39;. Defaults</span>
<span class="sd">                to &#39;center&#39;.</span>
<span class="sd">            font_name (str, optional):</span>
<span class="sd">                The name of the font typeface. Defaults to &#39;Calibri&#39;.</span>
<span class="sd">            font_size (int or float, optional):</span>
<span class="sd">                The font size. Defaults to 24.</span>
<span class="sd">            bold (bool, optional):</span>
<span class="sd">                If true, text will be formatted in bold. Defaults to False.</span>
<span class="sd">            italic (bool, optional):</span>
<span class="sd">                If true, text will be formatted in italics. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
            <span class="n">text_obj</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">PP_ALIGN</span><span class="o">.</span><span class="n">CENTER</span>
        <span class="k">if</span> <span class="n">alignment</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
            <span class="n">text_obj</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">PP_ALIGN</span><span class="o">.</span><span class="n">LEFT</span>

        <span class="n">font_obj</span> <span class="o">=</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">font</span>
        <span class="n">font_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">font_name</span>
        <span class="n">font_obj</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">ppt</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">Pt</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
        <span class="n">font_obj</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="n">bold</span>
        <span class="n">font_obj</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span> <span class="n">italic</span></div>

<div class="viewcode-block" id="PerformanceReport.CheckTargets"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.CheckTargets">[docs]</a>    <span class="k">def</span> <span class="nf">CheckTargets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_vals</span><span class="p">,</span> <span class="n">metric</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate how many sensors met a metric target, return textual</span>
<span class="sd">        depiction.</span>

<span class="sd">        For a passed metric name &#39;metric&#39;, determine the number of sensors</span>
<span class="sd">        with metric values within the specified metric target range.</span>

<span class="sd">        **Example:**</span>

<span class="sd">            Say the &#39;metric&#39; argument is &#39;CV&#39; and the &#39;metric_vals&#39; argument is</span>
<span class="sd">            ``[20.2, 43.6, 26.5]`` (values are percentages). Given that the</span>
<span class="sd">            target range for &#39;CV&#39; is from 0% to 30%, two our of three sensors</span>
<span class="sd">            fall within the target range. Textually, this can be represented by</span>
<span class="sd">            a series of three dots, where two dots are closed and one is empty.</span>

<span class="sd">            Text returned by ``CheckTargets()``\:</span>

<span class="sd">                &#39;â—â—â—‹&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            metric_vals (float, int, or list):</span>
<span class="sd">                Evaluation results for the indicated performance metric.</span>
<span class="sd">            metric (str):</span>
<span class="sd">                The name of the performance metric.</span>

<span class="sd">        Returns:</span>
<span class="sd">            text (str):</span>
<span class="sd">                A textual representation of the number of sensors meeting the</span>
<span class="sd">                target range criteria for the performance metric.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">device_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;R^2&#39;</span><span class="p">,</span> <span class="s1">&#39;Slope&#39;</span><span class="p">,</span> <span class="s1">&#39;Intercept&#39;</span><span class="p">,</span> <span class="s1">&#39;Uptime&#39;</span><span class="p">]</span>
        <span class="n">group_metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CV&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;NRMSE&#39;</span><span class="p">]</span>

        <span class="c1"># Place float / int values (single-valued intersensor stats) into</span>
        <span class="c1"># list for parsing</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">metric_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">metric_vals</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">metric</span> <span class="o">!=</span> <span class="s1">&#39;Uptime&#39;</span><span class="p">:</span>
            <span class="n">metric_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">PerformanceTargets</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>
            <span class="n">metric_bounds</span> <span class="o">=</span> <span class="n">metric_info</span><span class="p">[</span><span class="s1">&#39;bounds&#39;</span><span class="p">]</span>
            <span class="n">metric_min</span><span class="p">,</span> <span class="n">metric_max</span> <span class="o">=</span> <span class="n">metric_bounds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Uptime_min</span><span class="p">,</span> <span class="n">Uptime_max</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span>
            <span class="n">metric_min</span><span class="p">,</span> <span class="n">metric_max</span> <span class="o">=</span> <span class="n">Uptime_min</span><span class="p">,</span> <span class="n">Uptime_max</span>

        <span class="c1"># Number of sensors meeting target</span>
        <span class="n">n_sensors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">metric_vals</span><span class="p">)</span>
        <span class="n">n_passed</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">metric_min</span> <span class="o">&lt;=</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">metric_max</span> <span class="k">for</span> <span class="n">val</span>
                       <span class="ow">in</span> <span class="n">metric_vals</span><span class="p">)</span>

        <span class="n">device_o_symb</span> <span class="o">=</span> <span class="s1">&#39;â—‹&#39;</span>
        <span class="n">device_c_symb</span> <span class="o">=</span> <span class="s1">&#39;â—&#39;</span>

        <span class="n">group_o_symb</span> <span class="o">=</span> <span class="s1">&#39;â˜†&#39;</span>
        <span class="n">group_c_symb</span> <span class="o">=</span> <span class="s1">&#39;â˜…&#39;</span>

        <span class="k">if</span> <span class="n">n_sensors</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pcnt_passed</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">n_passed</span> <span class="o">/</span> <span class="n">n_sensors</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">device_metrics</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">n_passed</span><span class="o">*</span><span class="n">device_c_symb</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_sensors</span> <span class="o">-</span> <span class="n">n_passed</span><span class="p">)</span><span class="o">*</span><span class="n">device_o_symb</span>
            <span class="k">if</span> <span class="n">n_sensors</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;Uptime&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pcnt_passed</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="n">device_c_symb</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="n">device_o_symb</span>
            <span class="c1"># If only one sensor and no sensors passed</span>
            <span class="k">if</span> <span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">device_o_symb</span>

        <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">group_metrics</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pcnt_passed</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">group_c_symb</span>
            <span class="k">elif</span> <span class="n">n_sensors</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">group_o_symb</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Metric values empty?</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">group_o_symb</span>

        <span class="k">return</span> <span class="n">text</span></div>

<div class="viewcode-block" id="PerformanceReport.CreateReport"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.CreateReport">[docs]</a>    <span class="k">def</span> <span class="nf">CreateReport</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for running the various methods that construct reports.</span>

<span class="sd">        Existing figures are assumed to have been created on the same day of</span>
<span class="sd">        class instantiation. If a figure filename is not found, sensor data</span>
<span class="sd">        are loaded via the SensorEvaluation class and the figure is generated.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Creating Testing Report for&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">ref_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hourly_ref_df</span><span class="o">.</span><span class="n">Data_Source</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">MET_DATA</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">met_hourly_ref_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Warning: No Meteorological data for reference&#39;</span>
                          <span class="s1">&#39; source. Met plots will not be added to the report&#39;</span><span class="p">)</span>
            <span class="n">MET_DATA</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Set figure positions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FigPositions</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Adding figures to report&#39;</span><span class="p">)</span>
        <span class="c1"># Add figures to report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddSingleScatterPlot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddTimeseriesPlot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddMetricsPlot</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Adding tabular data&#39;</span><span class="p">)</span>
        <span class="c1"># Modify report tables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EditSiteTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EditSensorTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EditRefTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EditRefConcTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EditTabularStats</span><span class="p">()</span>

        <span class="c1"># Reference dependent details. Only add met plots if reference data</span>
        <span class="c1"># come from AirNowTech or another source where met data are provided</span>
        <span class="k">if</span> <span class="n">MET_DATA</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AddMetDistPlot</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AddMetInflPlot</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EditMetCondTable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">EditMetInfTable</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AddMultiScatter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EditHeader</span><span class="p">()</span>

        <span class="c1"># Move the supplemental info slide to the last slide position</span>
        <span class="n">slides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">slides</span>
        <span class="n">slide</span> <span class="o">=</span> <span class="n">slides</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">new_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">slides</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MoveSlide</span><span class="p">(</span><span class="n">slides</span><span class="p">,</span> <span class="n">slide</span><span class="p">,</span> <span class="n">new_idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddSlideNumbers</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SaveReport</span><span class="p">()</span></div>

<div class="viewcode-block" id="PerformanceReport.SaveReport"><a class="viewcode-back" href="../../../api/_autosummary/sensortoolkit.evaluation_objs._performance_report.PerformanceReport.html#sensortoolkit.evaluation_objs._performance_report.PerformanceReport.SaveReport">[docs]</a>    <span class="k">def</span> <span class="nf">SaveReport</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the report to the ``/reports`` directory as a pptx file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Saving report&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rpt_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Base_Testing_Report_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">today</span><span class="si">}</span><span class="s1">.pptx&#39;</span>

        <span class="n">save_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;reports&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_name</span><span class="p">)</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rpt_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;..Creating directory:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;....&#39;</span> <span class="o">+</span> <span class="n">save_dir</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;....&#39;</span> <span class="o">+</span> <span class="n">save_path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rpt</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, United States Environmental Protection Agency.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>